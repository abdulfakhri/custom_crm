
<!DOCTYPE html>
    <html class="page" lang="en">
        
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="format-detection" content="telephone=no">
        <meta name="format-detection" content="date=no">
        <meta name="format-detection" content="address=no">
        <meta name="format-detection" content="email=no">
        <meta content="notranslate" name="google">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="csrf-param" content="_csrf">
<meta name="csrf-token" content="rf_gsghjspmvHhoodgGCBJf7YO0hJRVc_0plcdMLrwL-jL_3ZQr1_JZSWGMTNLc0woEUrG5JZxfLIREcuV_7QA==">
        <title>My Dashboard</title>
        <script>window.contextPath = '';
                    window.allstate = false; 
                var forceShrink = false;
        var sidebarOpen = false;
        </script>
        <link rel="shortcut icon" href="/images/axpress.png"  />
        <meta name="description" content="">
        <link href="/assets/all-5aab6339af7bcb16c463e2c5045bd3d0.css" rel="stylesheet">
<script src="/assets/all-21c659272bf4a8bd8c2e1784f64458b8.js"></script>
<script src="/assets/4bf0ff89/bootstrap-select/dist/js/bootstrap-select.js"></script>
    </head>
    <body class="page-body az-menu-small  page-dashboard" style="">
        <!-- New Sidemenu -->
    <div id="dialer-page-mask"></div>
    <div id="pageMask"></div>
    <audio id="notifyPopupSound" preload="auto" src ="https://assets.agencyzoom.com/audio/sound-effect.mp3"></audio>

    <div class="az-notif-popup">
        <div class="az-notif-popup__top">
            <h2>information notification</h2>
    
            <div class="az-notif-popup__close">
                <i class="far fa-times"></i>
            </div>
        </div>
    
        <div class="az-notif-popup__main">
            <div class="az-notif-row">
                <div class="az-notif-row__left">
                    <div class="az-notif-row__avatar">
                        AD
                    </div>
                    <div class="az-notif-row__info">
                        <div class="az-notif-row__action">
                            Alexander Doe moved lead Smith James to next stage
                        </div>
    
                        <div class="az-notif-row__meta">
                            4 hours ago
                        </div>
                    </div>
                </div>
    
                <div class="az-notif-row__status">
                    <span></span>
                </div>
            </div>
        </div>
    </div>

<!--<div class="az-notif-popup az-notif-popup--danger" style="display: none;">-->
<!--    <div class="az-notif-popup__top">-->
<!--        <h2>information notification</h2>-->
<!---->
<!--        <div class="az-notif-popup__close">-->
<!--            <i class="far fa-times"></i>-->
<!--        </div>-->
<!--    </div>-->
<!---->
<!--    <div class="az-notif-popup__main">-->
<!--        <div class="az-notif-row az-notif-row--danger">-->
<!--            <div class="az-notif-row__left">-->
<!--                <div class="az-notif-row__avatar"><i class="fas fa-bell-exclamation"></i></div>-->
<!--                <div class="az-notif-row__info">-->
<!--                    <div class="az-notif-row__action">-->
<!--                        AMS Integration Name failed to login-->
<!--                    </div>-->
<!---->
<!--                    <div class="az-notif-row__meta">-->
<!--                        4 days ago-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!---->
<!--            <div class="az-notif-row__status">-->
<!--                <span></span>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!---->
<!--<div class="az-notif-popup az-notif-popup--success" style="display: none;">-->
<!--    <div class="az-notif-popup__top">-->
<!--        <h2>information notification</h2>-->
<!---->
<!--        <div class="az-notif-popup__close">-->
<!--            <i class="far fa-times"></i>-->
<!--        </div>-->
<!--    </div>-->
<!---->
<!--    <div class="az-notif-popup__main">-->
<!--        <div class="az-notif-row az-notif-row--success">-->
<!--            <div class="az-notif-row__left">-->
<!--                <div class="az-notif-row__avatar"><i class="fas fa-address-card"></i></div>-->
<!--                <div class="az-notif-row__info">-->
<!--                    <div class="az-notif-row__action">-->
<!--                        Lead John Doe Smith is sold-->
<!--                    </div>-->
<!---->
<!--                    <div class="az-notif-row__meta">-->
<!--                        5 days ago-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!---->
<!--            <div class="az-notif-row__status">-->
<!--                <span></span>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->    <div class="az-sidemenu-holder d-print-none ">
    <div class="az-sidemenu  shrink">
            <div class="az-sidemenu__logo">
    <img class="az-sidemenu__logo-open" src="/img/gamma/az-logo-full-white.png">
    <img class="az-sidemenu__logo-close" src="/img/gamma/az-logo-symbol.svg">
    <a href="javascript:void(0);" class="az-sidemenu__toggler az-sidemenu__toggler--close  disable ">
        <i class="fas fa-chevron-left"></i>
    </a>
    <a href="javascript:void(0);" class="az-sidemenu__toggler az-sidemenu__toggler--open  active">
        <i class="fas fa-chevron-right"></i>
    </a>
</div>

<div class="az-sidemenu__actions">
    

        <a id="manual-entry" href="/entry/index" class="az-sidemenu__action manual-entry az-tooltip" title="Add Business"><i class="far fa-plus"></i>
            <span>Add Business</span>
        </a>


<script>
    $(function () {
        var bdocSplash = '1';
        if(bdocSplash) {
            $("#uploadPC").click(function () {
                $('#bdocSplash').modal('show');
            })
        }
    })
</script></div>

<div class="az-sidemenu__main-nav">
    <div data-simplebar>
        <ul class="az-sidemenu__main-nav-inner">
            <li class="menudashboard">
                <a href="/dashboard/index" title="Dashboard" class="az-tooltip">
                    <i class="fal fa-circle-notch"></i>
                    <em>Dashboard</em>
                    <span class="azs-info d-none" id="goal-left"></span>
                </a>
            </li>
            <li class="menutodaysTask">
                <a href="/journey/task/my" title="Today's Tasks" class="az-tooltip">
                    <i class="fal fa-calendar-check"></i>
                    <em>Today's Tasks</em>
                    <span class="azs-info" id="task-left"></span>
                </a>
            </li>
            <li class="menuleads">
                <a href="/referral/pipeline" title="Leads" class="az-tooltip">
                    <i class="fal fa-address-card"></i>
                    <em>Leads</em>
                </a>
            </li>
            <li class="menucustomers">
                <a href="/customer/list" title="Customers" class="az-tooltip">
                    <i class="fal fa-users"></i>
                    <em>Customers</em>
                </a>
            </li>
                        <li class="menucontacts d-none">
                <a href="/contact/list" title="Contacts" class="az-tooltip">
                    <i class="fal fa-id-card-alt"></i>
                    <em>Contacts</em>
                </a>
            </li>

            <li class="azs-activities has-additional-menu menuactivities">
                <a href="javascript:void(0);" title="Activities">
                    <i class="fal fa-list-alt"></i>
                    <em>Activities</em>
                                            <span class="locked-feature">
                            <i class="fal fa-lock"></i>
                        </span>
                                    </a>
            </li>   

            <li class="azs-reports has-additional-menu menureports" >
                <a href="#" title="Reports" class="az-tooltip">
                    <i class="fal fa-analytics"></i>
                    <em>Reports</em>
                </a>
            </li>

            <li class="menucompensation">
                <a href="/finance/my" class="az-tooltip" title="Compensation">
                    <i class="fal fa-money-check-alt"></i>
                    <em>Compensation</em>
                    <span class="azs-info" id="my-comp"></span>
                </a>
            </li>

            
                                  
            
                            <li class="menuEmails email-sync-entrance">
                    <a href="/integration/conversation/index" title="Conversations" class="az-tooltip az-submenu-conversation">
                        <i class="fal fa-comments"></i>
                        <em>Conversations</em>
                        <sub class="d-none">0</sub>
                    </a>
                </li>
                    </ul>
    </div>
</div>
<div class="az-sidemenu__bottom">
    <div class="az-sidemenu__main-nav">
        <ul class="az-sidemenu__main-nav-inner">
                        
            <li class="az-sidemenu__has-border">
                <a href="/hr/index" class="az-tooltip" title="Agency HR <i class='fal fa-lock' style='margin-left: 3px; font-size: 11px; position: relative; top: -1px;'></i>">
                    <i class="fal fa-clock"></i>
                    <em>Agency HR</em>
                                        <span class="locked-feature">
                        <i class="fal fa-lock"></i>
                    </span>
                                    </a>
            </li>
    
            <li class="az-sidemenu__has-submenu">
                
<a href="javascript:void(0);">
    <i class="fal fa-question-circle"></i>
    <em>Help</em>
</a>
<div class="az-sidemenu__submenu">
    <div class="az-sidemenu__nav">
        <ul>
            <li>
                <a target="_blank" href="https://agencyzoom.as.me/basicIAtraining">
                    <i class="far fa-calendar"></i> Schedule a Training Session
                </a>
            </li>
            <li>
                <a href="https://support.agencyzoom.com/" target="_blank">
                    <i class="far fa-question-circle"></i> Search our Help Center
                </a>
            </li>
            <li>
                <a target="_blank" href="https://training.agencyzoom.com/iatraining">
                    <i class="far fa-train"></i> On-Demand Training
                </a>
            </li>
        
            <li>
                <a target="_blank" href="/help/roadmap">
                    <i class="far fa-road"></i> Roadmap
                </a>
            </li>

            <li>
                <a target="_blank" href="https://zoom.us/join">
                    <i class="far fa-desktop"></i>Screen Share
                </a>
            </li>
        </ul>
    </div>
</div>            </li>
                        <li class="az-sidemenu--profile az-sidemenu__has-submenu">
                <a href="javascript:void(0)">
                    <i class="fal fa-user-circle"></i>
                    <em>Abdul Freelancer</em>
                </a>
                <div class="az-sidemenu__submenu">
                    <div class="az-sidemenu__submenu-header az-sidemenu__submenu-header--big">
                        <a href="javascript:void(0);" class="az-sidemenu__submenu-userholder">
                            <div class="az-sidemenu__submenu-avatar">
                                <img
                                        class="rounded-circle avatar rounded-circle" height=50
                                        src="https://s3.amazonaws.com/az-static/avatar/dorp/7/89/u78960.png"
                                        onError='this.onerror=null;this.src=LetterAvatar("Abdul Freelancer", 50);' />
                            </div>
                            <div class="az-sidemenu__submenu-username">
                                Abdul Freelancer                            </div>
                        </a>
                    </div>
                    
                    <div class="az-sidemenu__nav">
                        <ul class="link-border-bottom">
                                                        <li>
                                <a href="/integration/email/email-setting/index?v=Gmail#app-settings">Email Settings</a>
                            </li>
                                                    </ul>
                    </div>
                    <div class="az-sidemenu__nav">
                        <ul>
                                                                                                                <li>
                                <a href="/my/profile">My Profile</a>
                            </li>
                                                        <li>
                                <a href="/my/meeting-link">My Meeting Link</a>
                            </li>
                                                        <li>
                                <a href="/referral/my-referral-site">My Referral site</a>
                            </li>
                            <li>
                                <a href="/journey/task/my">My Tasks</a>
                            </li>
                            <li>
                                <a href="/finance/my">My Compensation</a>
                            </li>
                                                    </ul>
                    </div>
                        
                    <div class="az-sidemenu__nav link-border-top">
                        <ul>
                            <li>
                                <a href="/site/logout">
                                    <i class="far fa-sign-out"></i> Log Out
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </li>
        </ul>
    </div>
</div></div>
</div>

<div class="az-expanded-navs d-print-none">
    <div class="az-expanded-nav azs-am-reports " data-simplebar>
        <div class="az-expanded-nav__heading">
            <h4>Reports</h4>
        </div>
                <div class="az-expanded-nav__container">
            <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Leads</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                        <li class="">
                            <a href="/lead-report/index">Conversion by Producer</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=closeRateByLeadSource">Conversion by Lead Source</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=byStage">Funnel by Producer</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=byStageAndLeadSource">Funnel by Lead Source</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=byProducer">Activity by Producer</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=byLeadSource">Activity by Lead Source</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=byMonth">Activity by Month</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=lossByProducer">Loss By Producer</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=lossByLeadSource">Loss By Lead Source</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=referral">Referrals</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=carrierQuoteResponse">Carrier Quote Response</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=webLeadReport">Web Lead Report</a>
                        </li>
                                            </ul>
                </div>
            </div>
                        <div class="az-expanded-nav__holder  ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>New Business</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                        <li class="">
                            <a href="/sales-report/index">Sales by Producer</a>
                        </li>
                                                                        <li class="">
                            <a href="/sales-report/index?report=byLeadSource">Sales by Lead Source</a>
                        </li>
                                                <li class="">
                            <a href="/sales-report/index?report=byLine">Sales by Policy Line</a>
                        </li>
                                                <li class="">
                            <a href="/sales-report/index?report=byZipcode">Sales by Zip Code</a>
                        </li>
                                                <li class="">
                            <a href="/sales-report/index?report=byCarrier">Sales by Carrier</a>
                        </li>
                                                <li class="">
                            <a href="/sales-report/index?report=byLocation">Sales by Location</a>
                        </li>
                                                <li class="">
                            <a href="/sales-report/index?report=byCsr">Sales by CSR</a>
                        </li>
                                                                        <li class="">
                            <a href="/report/index?report=detail">Daily Sales Details</a>
                        </li>
                                                <li class="">
                            <a href="/report/index?report=daily">Daily Sales Summary</a>
                        </li>
                                                <li class="">
                            <a href="/report/index?report=monthly">Monthly Sales Summary</a>
                        </li>
                                                <li class="">
                            <a href="/report/index?report=annual">Annual Sales Summary</a>
                        </li>
                                                <li class="">
                            <a href="/report/index?report=bundle">Mono-Line by Producer</a>
                        </li>
                                                                    </ul>
                </div>
            </div>

            	
            <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Broker Fees</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">

                        <li class="">
                            <a href="/brokerfee-report/index">Broker Fees by Producer</a>
                        </li>  
                        <li class="">
                            <a href="/brokerfee-report/index?report=byCarrier">Broker Fees by Carrier</a>
                        </li>
            
                        </ul>
                </div>
            </div>
                  
                                    <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Book of Business</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                                                                                <li class="">
                                <a href="/bizbook-report/index?report=byProducer">Sales by Producer</a>
                            </li>
                                                                                                            <li class="">
                                <a href="/bizbook-report/index?report=byCarrier">Sales by Carrier</a>
                            </li>
                                                                                                            <li class="">
                                <a href="/bizbook-report/index?report=byLine">Sales by Policy Line</a>
                            </li>
                                                                                                            <li class="">
                                <a href="/bizbook-report/index?report=byZipcode">Sales by Zipcode</a>
                            </li>
                                                                                                            <li class="">
                                <a href="/report/index?report=bobAnnual">Annual Sales Summary</a>
                            </li>
                                                                        </ul>
                </div>
            </div>
            
            
              
            <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Life and Health</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                                                <li class="">
                            <a href="/sales-report/index?report=lhByProducer">Funnel by Producer</a>
                        </li>
                                            <li class="">
                            <a href="/sales-report/index?report=lhActivity">Activity by Producer</a>
                        </li>
                                            <li class="">
                            <a href="/sales-report/index?report=lhActivityByLeadSource">Activity by Lead Source</a>
                        </li>
                                        </ul>
                </div>
            </div>
            
                        <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Goals</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                                                    <li class="">
                                <a href="/goal-report/index?report=diff">Monthly Sales vs Goal</a>
                            </li>
                                                    <li class="">
                                <a href="/goal-report/index?report=onpace">Stay on Pace</a>
                            </li>
                                            </ul>
                </div>
            </div>
                        <div class="az-expanded-nav__holder ">
                <a href="javascript:void(0);" class="az-expanded-nav-toggler">
                    <span>Activities</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                                                <li class="">
                            <a href="/locked-feature/index">
                                Manually Logged Activity - Daily                                                                    <span class="locked-feature">
                                        <i class="fal fa-lock"></i>
                                        </span>
                                                            </a>
                        </li>
                                                <li class="">
                            <a href="/locked-feature/index">
                                Manually Logged Activity - Weekly                                                                    <span class="locked-feature">
                                        <i class="fal fa-lock"></i>
                                        </span>
                                                            </a>
                        </li>
                                                <li class="">
                            <a href="/locked-feature/index">
                                Manually Logged Activity - Monthly                                                                    <span class="locked-feature">
                                        <i class="fal fa-lock"></i>
                                        </span>
                                                            </a>
                        </li>
                                                <li class="">
                            <a href="/locked-feature/index">
                                Manually Logged Activity - Trending
                                                                    <span class="locked-feature">
                                        <i class="fal fa-lock"></i>
                                        </span>
                                                            </a>
                        </li>

                        <hr class="mt-1 mb-1">

                                                <li class="">
                            <a href="/lead-report/index?report=activityByProducer">Activities by Producer</a>
                        </li>
                                                <li class="">
                            <a href="/lead-report/index?report=activityByMonth">Activities by Month</a>
                        </li>
                                            </ul>
                </div>
            </div>
            
            <!-- Others -->
                        <div class="az-expanded-nav__holder ">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Others</span>
                    <i class="fas fa-chevron-right"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                        <li class="">
                            <a href="/others-report/index?report=unsubscriptions">Unsubscriptions</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    
<div class="az-expanded-nav azs-am-lifecycle-automation " data-simplebar>
    <div class="az-expanded-nav__heading">
        <h4>Lifecycle Automation</h4>
    </div>
    <div class="az-expanded-nav__container">
        <div class="az-expanded-nav__holder ">
            <a href="#" class="az-expanded-nav-toggler">
                <span>Prospecting</span>
                <i class="fas fa-chevron-right"></i>
            </a>
            <div class="az-expanded-nav-content">
                                <ul class="az-expanded-nav__inner ">
                    <li class="az-expanded-nav__inner-toggle">
                        <a href="#">
                            <span>Pipeline</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                    <li class="az-expanded-nav__inner-menu">
                        <ul>
                                                            <li class="" >
                                    <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=51929">NEW</a>
                                </li>
                                                            <li class="" >
                                    <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=51930">Contacted</a>
                                </li>
                                                            <li class="" >
                                    <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=52808">Waiting on Quote</a>
                                </li>
                                                            <li class="" >
                                    <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=51931">Quoted</a>
                                </li>
                                                            <li class="" >
                                    <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=54404">Quoted HOT</a>
                                </li>
                                                    </ul>
                    </li>

                </ul>
                                <ul class="az-expanded-nav__inner open">
                    <li class="">
                        <a href="/workflow/ruleEditor/lead-rule-editor?workflowStageId=stg5">Smart-Cycle</a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="az-expanded-nav__holder ">
            <a href="#" class="az-expanded-nav-toggler">
                    <span> Onboarding</span>
                <i class="fas fa-chevron-right"></i>
            </a>
            <div class="az-expanded-nav-content">
                <ul class="az-expanded-nav__inner">
                                        <li>
                        <a href="javascript:void(0);">Personal Lines</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=personal&customerType=new">New Customers</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=personal&customerType=existing">Cross-Sold Policies</a>
                    </li>
                                        <li>
                        <a href="javascript:void(0);">Commercial Lines</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=commercial&customerType=new">New Customers</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=commercial&customerType=existing">Cross-Sold Policies</a>
                    </li>
                                        <li>
                        <a href="javascript:void(0);">Life & Health</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=life_and_health&customerType=new">New Customers</a>
                    </li>
                    <li class="pl-3 ">
                        <a href="/journey/journey/index?category=life_and_health&customerType=existing">Cross-Sold Policies</a>
                    </li>
                                    </ul>
            </div>
        </div>

        <div class="az-expanded-nav__holder ">
            <a href="javascript:void(0)" class="az-expanded-nav-toggler ">
                <span>Retain</span>
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        <div class="az-expanded-nav-content">
                <ul class="az-expanded-nav__inner">
                                            <li class="">
                            <a href="/workflow/ruleEditor/retain-rule-editor?policyClass=P" >Personal Lines</a>
                        </li>
                                            <li class="">
                            <a href="/workflow/ruleEditor/retain-rule-editor?policyClass=C" >Commercial</a>
                        </li>
                                            <li class="">
                            <a href="/workflow/ruleEditor/retain-rule-editor?policyClass=LH" >Life and Health</a>
                        </li>
                                    </ul>
            </div>
                    </div>
                <div class="az-expanded-nav__holder ">
            <a href="/workflow/ruleEditor/service-rule-editor" class="az-expanded-nav-toggler locked-feature">
                <span>Service</span>
                            </a>
                    </div>
                <div class="az-expanded-nav__holder ">
            <div class="locked-feature">
                <a  class="az-expanded-nav-toggler locked-feature " href="/workflow/ruleEditor/occasion-rule-editor" class="az-expanded-nav-toggler">
                    <span>Events</span>
                </a>
            </div>
        </div>

            </div>
</div>
    <div class="az-expanded-nav azs-am-activities " data-simplebar>
        <div class="az-expanded-nav__heading">
            <h4>Activities</h4>
        </div>

        <div class="az-expanded-nav__container">
            <div class="az-expanded-nav__holder">
            <a class="az-expanded-nav-toggler" href="/activity/dashboard">Activity Dashboard</a>
            </div>
        </div>
       
        
               
        <div class="az-expanded-nav__container">
            <div class="az-expanded-nav__holder open">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Setup</span>
                    <i class="fas fa-chevron-down"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                        <li class="">
                            <a href="/activitysetup/types">Activity Types</a>
                        </li>
                        <li class="">
                            <a href="/activitysetup/holidays">Agency Holidays</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="az-expanded-nav__holder open">
                <a href="#" class="az-expanded-nav-toggler">
                    <span>Activity Data</span>
                    <i class="fas fa-chevron-down"></i>
                </a>
                <div class="az-expanded-nav-content">
                    <ul class="az-expanded-nav__inner">
                        <li class="">
                            <a href="/activity/massedit">Mass Update</a>
                        </li>
                        <li class="">
                            <a href="/activity/missing">Missing Activity Dates</a>
                        </li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="az-expanded-nav azs-am-my-account " data-simplebar>
        <div class="az-expanded-nav__heading">
            <h4>My Account</h4>
        </div>

        <div class="az-expanded-nav__container">
            <div class="az-expanded-nav__holder ">
                <a class="az-expanded-nav-toggler " href="/account/my-payment-plan">My Payment Plan</a>
            </div>
            <div class="az-expanded-nav__holder ">
                <a class="az-expanded-nav-toggler " href="/account/index">My Recent Payments</a>
            </div>
            <div class="az-expanded-nav__holder ">
                <a class="az-expanded-nav-toggler " href="/account/updatecreditcard">My Credit Card Information</a>
            </div>
            <div class="az-expanded-nav__holder ">
                <a class="az-expanded-nav-toggler " href="/account/cancel">Cancel My Account</a>
            </div>
        </div>
    </div>
</div>

                <div class="page-content">
<!--            TODO    -->
            <div class="main " >
                                                    

<div id="gamma-dashboard">
    <div class="main-header dashboard-header">
        <h2>Main Dashboard</h2>
        <div class="d-flex mx-1">
            
            <div class="dock-wrapper" id="calendarPanel">
	<div class="dock-dim d-none"></div>

	<div class="dock-container lg right">
		<div class="dock-resizer"></div>
		<div class="dock-content">
			<div class="az-dock__header">
                <div class="az-dock__top">
                    <div class="az-dock__top-heading d-flex align-items-center">
                        <div class="icon-circle mr-2">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <h3 class="currentCustomerName" style="width: auto;">At a Glance</h3>
                    </div>
                </div>

                <div class="az-dock__top-right">
                    <div class="az-dock__additional-options">
                        <a class="icon-nav-link az-tooltip-bottom" title="Show Full Screen" href="/appt/appt/calender"><i class="fal fa-expand"></i></a>
                                                <a class="icon-nav-link az-tooltip-bottom" title="Calendar Settings" href="/integration/email/email-setting/index#calendar-settings"><i class="fal fa-cogs"></i></a>
                        <a class="icon-nav-link az-tooltip-bottom" title="Share My Scheduling Page" href="#"  data-toggle="modal" data-target="#my-scheduler"><i class="fal fa-share-alt"></i></a>
                                            </div>

                    <div class="ml-2">
                        <ul class="nav nav-tabs dock-tabs nav-tabs--light" id="calendar-data" style="font-size: 12px;" role="tablist">
                            <li class="nav-item" role="presentation">
                                <a href="#uirMy" class="nav-link unMatchVisibleArea active" id="my-calendar" data-type="my" data-toggle="tab"><i class="fal fa-user"></i>MÐµ</a>
                            </li>
                            <li class="nav-item" role="presentation">
                                <a href="#uirAll" class="nav-link unMatchVisibleArea" id="all-calendar" data-type="all" data-toggle="tab"><i class="fal fa-users"></i>Team</a>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="az-dock__close"  onClick="toggleDock(false, '#calendarPanel', 650)">
                        <i class="far fa-times"></i>
                    </div>
                </div>
			</div>

			<div class="dock-cards full-height">
                <iframe id="calendarContent" src="" width="100%" seamless frameborder="0" height="100%;"></iframe>                    
		    </div>
	    </div>
    </div>
</div>

<script>

function toggleDock(show, id, width, callback) {
	if (!id.startsWith('#')) {
		id = '#' + id; 
	}
	togglePanelWithSize(id, show, width);
	if (callback) callback(); 
}

</script>
<script>
$(function() {
	$('a.my-calendar').on('click', function(e) {
		e.preventDefault(); 
        if ($(this).data('loaded') == '0') {
            $(this).data('loaded', '1'); 
            $('#calendarContent').attr('src', '/appt/appt/calender?glance=1');
        }
        toggleDock(true, '#calendarPanel', 650);          
	}); 
    $('#my-scheduler').on('show.bs.modal', function (event) {
        if ($('#my-scheduler-content').attr('src') == '') {
            $('#my-scheduler-content').attr('src','/appt/appt/my-scheduler');
        }
    });
}); 
</script>
<div class="d-flex align-items-center">
<div class="dashboard-header__action dashboard-header__notif ml-2">
    <a href="javascript:void(0);" title="Notifications" class="az-tooltip az-submenu-trigger">
        <i class="fal fa-bell"></i>
        <span  class="badge d-none">0</span>
    </a>

    <div class="az-submenu" id="notify-sidebar">
        <div class="az-submenu__top">
            <div class="az-submenu__title">
                <h3 style="display: inline-table">Notifications</h3>
            </div>
        </div>

        <div class="az-submenu__main">
            <div class="az-notif-row__sub-actions">
                <div class="az-notif-row__sub-meta">
                    UNREAD
                </div>

            </div>

            <div class="today-notifications">
            </div>

        </div>

        <div class="az-submenu__bottom-action">
            <a href="/notify/index">
                <i class="far fa-eye"></i>
                View All
            </a>
        </div>
    </div>
</div>
</div>

        </div>
    </div>
    
    <div class="az-dashboard">
        

<div class="row">
    <div class="col-md-8">
        
<div class="card" style="height: 100%;" id="today-goal-stats">
    <div class="row mb-3">
        <div class="col-md-8">
            <div class="db-heading">
                <h3 id="today-hi">Hi Abdul,
                    here's <span class="goal-owner">your</span> goal for today</h3>
                <h3 id="today-congrats" style="display:none;">Congrats Abdul!
                                        You are on pace.
                                    </h3>
            </div>
        </div>
        <div class="col-md-4">
            <div class="db-nav-holder d-flex justify-content-end">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active primaryType todayGoalTypeSwitcher" href="#">...</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link secondaryType todayGoalTypeSwitcher" href="#">...</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-5">
            <div class="db-cards">
                <div class="db-card has-icon db-card-started-today-at">
                    <small>STARTED TODAY AT</small>
                    <h2><span class="mtd-sales">...</span></h2>
                </div>

                <div class="db-card has-icon db-card-should-be-at">
                    <small>SHOULD BE AT</small>
                    <h2><span class="mtd-goals">...</span></h2>
                </div>

                <div class="db-card has-icon db-card-todays-goal">
                    <h2><span class="today-goal">...</span></h2>
                    <small>GOAL FOR TODAY</small>
                </div>
            </div>
        </div>
        <div class="col-md-7">
            <div id="db-main-radialbar" style="min-height: 315px;"></div>
            <div class="db-chart-counter">
                <small>ACHIEVED TODAY</small>
                <h3 id="achievedToday">0</h3>
            </div>
        </div>
    </div>
</div>
<script>
    var todayChart = null;
    var todayDiff = 0;
    var todaySalesPercent = 0;
    function createTodayDiffChart(dataArray) {
        if (dataArray[0] == 0) {
            $('#today-congrats').show();
            $('#today-hi').hide();
        }
        else {
            $('#today-congrats').hide();
            $('#today-hi').show();
        }

        var noData = false;
        if (dataArray[0] == 0 && dataArray[1] == 0) {
            noData = true;
            dataArray = [0,1];
        }
        var options = {
            chart: {
                height:  400 ,
                type: "radialBar"
            },
            plotOptions: {
                colors: 'red',
                radialBar: {
                    inverseOrder: false,
                    hollow: {
                        margin: 0,
                        size: "83%",
                    },
                    track: {
                        show: true,
                        background: '#E8EBF0',
                    },
                    dataLabels: {
                        showOn: "always",
                        name: {
                            offsetY: 0,
                            show: true,
                            color: "#888",
                            fontSize: "15px",
                            offsetY: -30,
                            color: '#B8C1CD',

                        },
                        value: {
                            color: "#111",
                            fontSize: "60px",
                            show: true,
                            color: '#133159',
                            formatter: function (val) {
                                return todayDiff;
                            }

                        }
                    }
                }
            },
            series: [todaySalesPercent ],
        labels: ['STILL NEEDED'],

            fill: {
                colors: ['#2EFF9F']
            },
            stroke: {
                lineCap: "round",
            },
            responsive: [{
                breakpoint: 1399,
                options: {
                    chart: {
                        height: 360
                    },
                    plotOptions: {
                        radialBar: {
                            dataLabels: {
                                name: {
                                    fontSize: "22px",
                                    offsetY: -20
                                },
                                value: {
                                    fontSize: "50px",
                                    offsetY: 20,
                                }
                            }
                        }
                    }
                },
            }, {
                breakpoint: 1025,
                options: {
                    chart: {
                        height: 340
                    }
                },
            }]
        }
        $('#db-main-radialbar').html('');
        var todayChart = new ApexCharts(
            document.querySelector("#db-main-radialbar"),
            options
        );
        todayChart.render();
    }

</script>    </div>
    <div class="col-md-4">
        <div class="card monthly-stats" id="monthly-stats" style="height: 100%;">
            <div class="row mb-3">
                <div class="col-md-5">
                    <div class="db-heading d-flex align-items-center">
                        <h3>January stats</h3>
                    </div>
                </div>
                <div class="col-md-7">
                    <div class="db-nav-holder right">
                        <ul class="nav nav-tabs">
                            <li class="nav-item">
                                <a class="nav-link active primaryType monthGoalTypeSwitcher" href="#">...</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link secondaryType monthGoalTypeSwitcher" href="#">...</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12 db-card-parent">
                    
<div class="db-card db-card-center db-card-trending-for">
    <small>TRENDING FOR</small>
    <h2> <span class="trending-for trending-number"><i class="fa fa-spin fa-spinner"></i></span></h2>
    <div class="small-text"><span class="trending-percent">...</span> 
        <span class="trending-above">above</span> goal of <span class="month-goal">0</span>
    </div>
    <span class="progress-bar">
        <em id="trending-for-progress" style="width: 0%;"></em>
    </span>
</div>                </div>

                <div class="col-md-12 db-card-parent">
                    

<div class="db-card has-cols">
    <div class="db-card-holder">
        <div class="db-card-left vs-last-month">
            <small>VS LAST MONTH</small>
            <div class="title-has-icon">
                <h2><span id="vs-last-month-sales-percent">...</span></h2>
                <i class="fas fa-arrow-up"></i>
            </div>
        </div>
        
        <div class="db-card-right">
            <h2><span id="last-month-sales">...</span></h2>
            <small>LAST MONTH</small>
        </div>
    </div>
</div>                </div>

                <div class="col-md-12 db-card-parent">
                    

<div class="db-card has-cols" id="month-currently-at">
    <div class="db-card-holder">
        <div class="db-card-left currently-at">
            <small>CURRENTLY AT</small>
            <h2><span class="month-premiums">...</span></h2>
        </div>

        <div class="db-card-right">
            <h2><span class="month-premiums-percent">...</span></h2>
            <small>OF GOAL</small>
        </div>
    </div>
    <span class="progress-bar blue">
                                                <em style="width: 100%;"></em>
                                            </span>
</div>                </div>
            </div>
        </div>
    </div>
</div>
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-danger d-none" id="goal-setup-warning">
                                            Please notify your agency account manager or owner to setup your agency's sales goals.
                                    </div>
            </div>
           
            <div class="col-md-12">
                <div class="card db-main-tabs">
                    
<div class="dropdown">
    <a class="btn btn-outline dropdown-toggle" href="#" role="button" id="biz-type-label" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Written Business
    </a>

    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <a class="dropdown-item biztype-selector" href="#" data-type="written">Written Business</a>
                <a class="dropdown-item biztype-selector" href="#" data-type="alr">Life & Health</a>
        <a class="dropdown-item biztype-selector" href="#" data-type="activities">Activities</a>
        <a class="dropdown-item biztype-selector" href="#" data-type="analytics">Analytics</a>
            </div>
</div>
                    <div id="written">
                        
<div class="row" id="written-navbar">
    <div class="col-md-12">
        <div class="d-flex justify-content-end">
            <div class="db-nav-holder db-nav-tabs-main">
                <ul class="nav nav-tabs">
                                        <li class="nav-item">
                        <a class="nav-link written-nav-link show-db-nav-tabs-main active" data-toggle="tab" href="#written-charts">Chart</a>
                    </li>
                                        <li class="nav-item" >
                        <a class="nav-link written-nav-link hide-db-nav-tabs-main" data-toggle="tab" href="#lsp-policies">Details</a>
                    </li>
                </ul>
            </div>
            <div class="db-nav-holder db-nav-tabs-main ml-3" id="sales-charts">
                <ul class="nav nav-tabs">
                    <!-- referenced to written-business-details.php -->
                    <li class="nav-item d-none">
                        <a class="nav-link active" href="#items" data-toggle="tab">Items <span>0</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#premium" data-toggle="tab">Premium <span>0</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#policies" data-toggle="tab">Policies <span>0</span></a>
                    </li>
                                                        </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="tab-content">
            <div class="tab-pane written-tab-pane db-todays-goal-row" id="today-goal-body"></div>
            <div class="tab-pane written-tab-pane db-month-goal-row" id="month-goal-body"></div>

            <div class="tab-pane written-tab-pane active" id="written-charts">
                <div class="row no-gutters">
                    <div class="col-xl-3 filters-holder">
                        <div>
                            <h4 class="mb-3">Filters</h4>
                        </div>

                        <div class="filters-boxes">
                            <div class="filter-box">
    <h3>Time Frame</h3>
    <small class="dropdown-toggle period-label" data-toggle="dropdown">MTD</small>
    <div class="dropdown-menu">
        <li><a href="#" class="dropdown-item period-selector" data-period="mtd">MTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="qtd">QTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="today">Today</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="yesterday">Yesterday</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="ytd">YTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="thisweek">This Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastweek">Last Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastmonth">Last Month</a></li>
        <li role="separator" class="dropdown-divider"></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="customize">Customized</a></li>
            </div>
</div>
                            
                            <div class="filter-box">
    <h3>Carrier</h3>
    <small class="dropdown-toggle carrier-label" data-toggle="dropdown">All Carriers</small>
    <div class="dropdown-menu carrierDropdown">
        <a class="dropdown-item" href="javascript:void(0)">All</a>
    </div>
</div>                        </div>
                    </div>
                    <div class="col-xl-9">
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="items">
                                <div id="item-chart"></div>
                            </div>
                            <div role="tabpanel" class="tab-pane"  id="premium">
                                <div id="premium-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="policies">
                                <div id="policy-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="points">
                                <div id="point-chart"></div>
                            </div>

                                                    </div>
                    </div>
                </div>
            </div>

            
            <div class="tab-pane written-tab-pane" id="lsp-policies">
            


<div id="sales-list" class="row no-gutters written-policies">
    <div class="col-xl-3 filters-holder">
        <div>
            <h4 class="mb-3">Filters</h4>
        </div>

        <div class="filters-boxes">
            <div class="filter-box">
    <h3>Time Frame</h3>
    <small class="dropdown-toggle period-label" data-toggle="dropdown">MTD</small>
    <div class="dropdown-menu">
        <li><a href="#" class="dropdown-item period-selector" data-period="mtd">MTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="qtd">QTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="today">Today</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="yesterday">Yesterday</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="ytd">YTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="thisweek">This Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastweek">Last Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastmonth">Last Month</a></li>
        <li role="separator" class="dropdown-divider"></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="customize">Customized</a></li>
            </div>
</div>
            
            <div class="filter-box">
    <h3>Carrier</h3>
    <small class="dropdown-toggle carrier-label" data-toggle="dropdown">All Carriers</small>
    <div class="dropdown-menu carrierDropdown">
        <a class="dropdown-item" href="javascript:void(0)">All</a>
    </div>
</div>        </div>
    </div>
    <div class="col-xl-9 pl-3 db-table">
        <div class="az-icon-boxes">
            
            <div class="az-icon-box">
                <h4>Premium: <span class="text-primary" id="my-premiums">0</span></h4>
            </div>

            <div class="az-icon-box">
                <h4>Policies: <span class="text-primary" id="my-policies">0</span></h4>
            </div>

                        
                    </div>

        <table class="mt-3" cellpadding="12">
            <thead class="no-top-border nowrap">
                <tr class="batch-options-section">
                    <th colspan="5" class="batch-options">

                    </th>
                </tr>
                <tr>
                    <th><a  data-sort="housename" href="#">Customer <i class="fa fa-sort"></i></a></th>
                    <th class="text-center"><a  data-sort="date" href="#">Date <i class="fa fa-sort"></i></a></th>
                    <th class="text-center"><a  data-sort="policy" href="#">Policy <i class="fa fa-sort"></i></a></th>
                                        <th class="text-center"><a  data-sort="premiumValues" href="#">Premium <i class="fa fa-sort"></i></a></th>
                                    </tr>
            </thead>
            <tbody id="sales-detail-body">

            </tbody>
        </table>
    </div>
</div>            </div>
        </div>
    </div>
</div>                    </div>

                    <div id="issued" style="display:none;">
                        
<div class="row">
    <div class="col-md-12">
        <div class="d-flex justify-contend-end align-items-center">
            <div class="db-nav-holder db-nav-tabs-main">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#issued-charts">Chart</a>
                    </li>
                                                            <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#issued-sales-details">Details</a>
                    </li>
                                    </ul>
            </div>

            <div class="db-nav-holder ml-2">
                <ul class="nav nav-tabs" id="issued-sales-charts">
                    <!-- referenced to written-business-details.php -->
                    <li class="nav-item">
                        <a class="nav-link active" href="#issued-premium" data-toggle="tab">Premium</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#issued-items" data-toggle="tab">Items</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#issued-points" data-toggle="tab">Points</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="tab-content">
            <div class="tab-pane active" id="issued-charts">
                <div class="row no-gutters">
                    <div class="col-xl-3 filters-holder">
                        <div>
                            <h4 class="mb-3">Filters</h4>
                        </div>

                        <div class="filters-boxes">

                            
<div class="filter-box">
    <h3>Month</h3>
    <small class="dropdown-toggle month-label" data-toggle="dropdown">December 2021</small>
    <div class="dropdown-menu">
                <li><a href="#" class="dropdown-item month-selector" data-month="1" data-year="2022">January 2022</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="12" data-year="2021">December 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="11" data-year="2021">November 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="10" data-year="2021">October 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="9" data-year="2021">September 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="8" data-year="2021">August 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="7" data-year="2021">July 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="6" data-year="2021">June 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="5" data-year="2021">May 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="4" data-year="2021">April 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="3" data-year="2021">March 2021</a></li>
                <li><a href="#" class="dropdown-item month-selector" data-month="2" data-year="2021">February 2021</a></li>
                <li role="separator" class="dropdown-divider"></li>
        <li><a href="#" class="dropdown-item monthly-period-selector" data-period="customize">Customized</a></li>
    </div>
</div>
                            
                            <div class="filter-box">
    <h3>Carrier</h3>
    <small class="dropdown-toggle carrier-label" data-toggle="dropdown">All Carriers</small>
    <div class="dropdown-menu carrierDropdown">
        <a class="dropdown-item" href="javascript:void(0)">All</a>
    </div>
</div>                        </div>
                    </div>
                    <div class="col-xl-9">
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="issued-premium">
                                <div id="issued-premium-chart"></div>
                            </div>
                            <div role="tabpanel" class="tab-pane"  id="issued-items">
                                <div id="issued-item-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="issued-points">
                                <div id="issued-point-chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            
                        <div class="tab-pane" id="issued-sales-details">
                

<div class="row db-heading mt-3">
    <div class="col-3">
        <h4>Premium <span class="text-primary" id="my-issued-premiums">0</span></h4>
    </div>

    <div class="col-3">
        <h4>Items <span class="text-primary ml-10" id="my-issued-items">0</span></h4>
    </div>

    <div class="col-3">
        <h4>Points <span class="text-primary ml-10" id="my-issued-points">0</span></h4>
    </div>
</div>

<div id="issued-items" class="mt-3">
    <table class="table table-striped" id="allstate-issued">
        <thead>
        <tr>
            <th class=" text-muted">Customer</th>
            <th class="text-center text-muted">Net</th>
            <th class="text-center text-muted">Gross</th>
            <th class="text-center text-muted">Change</th>
        </tr>
        </thead>
        <tbody id="allstate-issued-body">

        </tbody>
    </table>

    <table class="table table-striped" id="ivantage-issued">
        <thead>
        <tr>
            <th>Vendor</th>
            <th>Customer</th>
            <th class="text-center">Product</th>
            <th class="text-center">Premium</th>
        </tr>
        </thead>
        <tbody id="ivantage-issued-body">

        </tbody>
    </table>

</div>            </div>
                    </div>
    </div>
</div>                    </div>

                    <div id="alr" style="display:none;">
                        
<div class="row">
    <div class="col-md-12">
        <div class="d-flex align-items-center justify-content-end">
            <div class="db-nav-holder db-nav-tabs-main">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#lifechart">Chart</a>
                    </li>
                                    </ul>
            </div>

            <div class="db-nav-holder ml-3" id="alr-charts">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link" href="#issued-ips" data-toggle="tab">Issued</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#issued-pc" data-toggle="tab">$ Issued</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#app-ips" data-toggle="tab">Submitted</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#app-pc" data-toggle="tab">$ Submitted</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#appts" data-toggle="tab">Appointments</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#leads" data-toggle="tab">Leads</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="tab-content">
            <div class="tab-pane active" id="lifechart">
                <div class="row no-gutters">
                    <div class="col-xl-3 filters-holder">
                        <div>
                            <h4 class="mb-3">Filters</h4>
                        </div>

                        <div class="filters-boxes">
                            <div class="filter-box">
    <h3>Time Frame</h3>
    <small class="dropdown-toggle period-label" data-toggle="dropdown">MTD</small>
    <div class="dropdown-menu">
        <li><a href="#" class="dropdown-item period-selector" data-period="mtd">MTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="qtd">QTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="today">Today</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="yesterday">Yesterday</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="ytd">YTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="thisweek">This Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastweek">Last Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastmonth">Last Month</a></li>
        <li role="separator" class="dropdown-divider"></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="customize">Customized</a></li>
            </div>
</div>
                                                    </div>
                    </div>

                    <div class="col-xl-9">
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="issued-ips">
                                <div id="issued-ips-chart"></div>
                            </div>
                            <div role="tabpanel" class="tab-pane"  id="issued-pc">
                                <div id="issued-pc-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="app-ips">
                                <div id="app-ips-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="app-pc">
                                <div id="app-pc-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="appts">
                                <div id="appts-chart"></div>
                            </div>

                            <div role="tabpanel" class="tab-pane "  id="leads">
                                <div id="leads-chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane db-table" id="alr-list">
                <table cellpadding="12">
                    <thead>
                        <tr class="batch-options-section">
                            <th colspan="7" class="batch-options">

                            </th>
                        </tr>
                        <tr>
                            <th rowspan="2">Name</th>
                            <th class="text-center border-bottom" colspan="2">Issued</th>
                            <th class="text-center border-bottom" colspan="2">Apps Submitted</th>
                            <th class="text-center" rowspan="2"><span class="desktop-only">Appointments</span><span class="phone-only">Appts</span><br>Set</th>
                            <th class="text-center" rowspan="2">Leads</th>
                        </tr>
                        <tr>
                            <th class="text-center"><span class="desktop-only">Policies</span><span class="phone-only">#</span></th>
                            <th class="text-center"><span class="desktop-only">Prod. Credit</span><span class="phone-only">$</span></th>
                            <th class="text-center"><span class="desktop-only">App</span><span class="phone-only">#</span></th>
                            <th class="text-center"><span class="desktop-only">Prod. Credit</span><span class="phone-only">$</span></th>
                        </tr>
                    </thead>
                    <tbody id="alr-list-body">

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>                    </div>

                    <div id="activities" style="display:none;">
                        <div class="row">
    <div class="col-md-12">
        <div class="d-flex align-items-center justify-content-end">
            <div class="db-nav-holder db-nav-tabs-main">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#activity-chart">Chart</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#activity-list">Summary</a>
                </li>
            </ul>
        </div>

        <div class="db-nav-holder ml-3" id="activity-charts"></div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-12">
        <div class="tab-content">

            <div class="tab-pane active" id="activity-chart">
                <div class="row no-gutters">
                    <div class="col-xl-3 filters-holder">
                        <div>
                            <h4 class="mb-3">Filters</h4>
                        </div>

                        <div class="filters-boxes">
                            <div class="filter-box">
    <h3>Time Frame</h3>
    <small class="dropdown-toggle period-label" data-toggle="dropdown">MTD</small>
    <div class="dropdown-menu">
        <li><a href="#" class="dropdown-item period-selector" data-period="mtd">MTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="qtd">QTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="today">Today</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="yesterday">Yesterday</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="ytd">YTD</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="thisweek">This Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastweek">Last Week</a></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="lastmonth">Last Month</a></li>
        <li role="separator" class="dropdown-divider"></li>
        <li><a href="#" class="dropdown-item period-selector" data-period="customize">Customized</a></li>
            </div>
</div>                        </div>
                    </div>

                    <div class="col-xl-9" id="activity-contents">

                    </div>
                </div>
            </div>

            <div class="tab-pane db-table" id="activity-list">

            </div>
        </div>
    </div>
</div>                    </div>

                    <div id="analytics" style="display:none;">
                        
<div id="analytics-charts">
    <div class="row">
        <div class="col-12">
            <div class="d-flex align-items-center justify-content-between">
                <div id="analyticsDropdown" class="dropdown">
                    <a id="analytics-label" class="btn btn-outline dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Written Business vs Goal
                    </a>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink" id="analyticsDropdownList">
                        <a class="dropdown-item" href="javascript:void(0);" data-type="written">Written Business vs Goal</a>
                                            </div>
                </div>

                <div class="db-nav-holder ml-3">
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link active" href="#analytics-1" data-toggle="tab" style="text-transform: capitalize">Items</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#analytics-2" data-toggle="tab" style="text-transform: capitalize">Items</a>
                        </li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xl-3 filters-holder">
            <div>
                <h4 class="mb-3">Filters</h4>
            </div>

            <div class="filters-boxes">
                            </div>
        </div>

        <div class="col-xl-9">
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="analytics-1">
                    <div id="analytics-1-chart"></div>
                </div>

                <div role="tabpanel" class="tab-pane"  id="analytics-2">
                    <div id="analytics-2-chart"></div>
                </div>
                            </div>
        </div>
    </div>
</div>                    </div>

                    <div id="terminations" style="display:none;">
                        
<div class="row">
    <div class="col-md-12">
        <div class="db-nav-holder right">
            <ul class="nav nav-tabs">
                <!-- referenced to written-business-details.php -->
                <li class="nav-item d-none">
                    <a class="nav-link" href="#termination-items" data-toggle="tab">Items</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#termination-premium" data-toggle="tab">Premium</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="#termination-policies" data-toggle="tab">Policies</a>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xl-3 filters-holder">
        <div>
            <h4 class="mb-3">Filters</h4>
        </div>

        <div class="filters-boxes">
                    </div>
    </div>
    <div class="col-xl-9">
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane" id="termination-items">
                <div id="termination-item-chart"></div>
            </div>
            <div role="tabpanel" class="tab-pane"  id="termination-premium">
                <div id="termination-premium-chart"></div>
            </div>

            <div role="tabpanel" class="tab-pane active"  id="termination-policies">
                <div id="termination-policy-chart"></div>
            </div>
        </div>
    </div>
</div>                    </div>
                </div>
            </div>
        </div>
    </div>

</div>



<div id="kitdlg" class="modal-custom modal fade splash-modal"  data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="personSalesLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document"><div class="modal-content">
    	<div class="modal-header modal-header-dark" style="height: auto;">
			<h2 class="modal-title">Hooray! Abdul</h2>
    	 	<button type="button" class="close d-none" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    		<div class="steps d-none">
        		<div class="zoom-steps-round"><div class="current"><div class="wrap"><div class="round">1</div><div class="bar"></div></div></div><div class="todo"><div class="wrap"><div class="round">2</div><div class="bar"></div></div></div><div class="todo"><div class="wrap"><div class="round">3</div><div class="bar"></div></div></div><div class="todo"><div class="wrap"><div class="round">4</div><div class="bar"></div></div></div><div class="todo last"><div class="wrap"><div class="round">5</div></div></div></div>    		</div>
      	</div>
        <div class="modal-body modal-body-sales" id="kitbody">
      	    <iframe id="kitContent" src="" width="100%" seamless frameborder="0" height="500px"></iframe>
      	</div>
      	
      	<div class="modal-footer modal-footer-cols pdf-buttons pdfviewer-buttons " style="display: none; border-top: 1px solid #E5E8EF;">
	      	<button style="width: 150px;" type="button" name="btnCancelExtract" id="btnCancelExtract" value="cancelextract" onclick="WelcomePacket.cancelextract()" class="pdf btn-sm btn btn-outline-primary float-left"><i class="fa fa-long-arrow-left"></i> Cancel</button>
			<button style="width: 150px;" type="button" name="btnExtractAll" id="btnExtractAll" value="extractAll" onclick="WelcomePacket.extractall()" class="pdf btn-sm btn btn-primary">Include All</button>
			<button style="width: 150px;" type="button" name="btnExtract" id="btnExtract" value="extract" onclick="WelcomePacket.extract()" class="pdf btn btn-sm btn-primary"><i class="fa fa-plus-circle"></i> Include Page</button>
			<button style="width: 150px;" type="button" name="btnUndoExtract" id="btnUndoExtract" value="unextract" onclick="WelcomePacket.unextract()" class="pdf btn btn-sm btn-outline-primary"><i class="fa fa-minus-circle"></i> Exclude Page</button>
			<button style="width: 150px;" type="button" name="btnDoneExtract" id="btnDoneExtract" value="doneextract" onclick="WelcomePacket.doneextract()" class="pdf btn btn-sm btn-success"><i class="fa fa-check-circle"></i> Done</button>
			<span id="extractStatus"></span>		
	      	
      	</div> 
      	
      	<div class="modal-footer modal-footer-cols preview-buttons pdfviewer-buttons text-center" style="display: none; border-top: 1px solid #E5E8EF;">
      		<button type="button" name="btnExitPreview" id="btnExitPreview" value="exitpreview" onclick="WelcomePacket.exitpreview()" 
				class="pdfpreview action btn-sm btn btn-outline-primary float-left"><i class="fa fa-long-arrow-left"></i> Back</button>
						<input placeholder="Customer Email Address" class="form-control" name="emailPdfpreview" id="emailPdfpreview" style="width:200px;display:inline-block; height:31px; line-height:31px;">
				
       	    <button type="button" name="btnEmailPreview" id="btnEmailPreview" value="emailpreview" 
				onclick="WelcomePacket.emailpreview()" class="pdfpreview btn-sm btn btn-primary mr-2"><i class="fal fa-envelope"></i> Email</button>
      	    <button type="button" name="btnDownloadPreview" id="btnDownloadPreview" value="downloadpreview" 
				onclick="WelcomePacket.downloadpreview()" class="pdfpreview action btn-sm btn btn-outline-primary"><i class="fal fa-download"></i> Download</button>
			<button id="btnEditPreview" name="btnEditPreview" type="button"  value="editPreview"
				onclick="WelcomePacket.editit()" class="pdfpreview action btn-sm btn btn-outline-primary"><i class="fal fa-pencil"></i> Edit</button>	
      	</div> 
      	
      	<div class="modal-footer modal-footer-cols wizard-buttons text-center" style="display: none; border-top: 1px solid #E5E8EF;">
      	    <button type="button" class="btn btn-outline wk-step back-step">Back</button>
        	<button type="button"  class="btn btn-primary wk-step next-step">Next</button>
      	</div> 
      	 
    </div></div>
</div>

<div id="entrydlg" class="modal-custom modal fade splash-modal" data-backdrop="static">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div class="modal-header modal-header-dark" style="height: auto;">
        	<h2 class="modal-title" id="entryTitle">Add Your New Policy</h2>
        	<div class="steps">
        		<div class="zoom-steps-round"><div class="current"><div class="wrap"><div class="round">1</div><div class="bar"></div></div></div><div class="todo last"><div class="wrap"><div class="round">2</div></div></div></div>    		</div>
      </div>
      <div class="modal-body modal-body-sales" id="entrybody">
      	    <iframe id="entryContent" src="" width="100%" seamless frameborder="0" height="550px;"></iframe>
      </div>
      <div class="modal-footer modal-footer-cols entry-wizard-buttons">
      	<button  type="button" name="btnCancelEntry" id="btnCancelEntry" class="actionable btn btn-outline wk-step">Cancel</button>
        <button type="button" name="btnNextEntry" id="btnNextEntry" value="btnNextEntry" onclick="WelcomePacket.nextEntry()" class="btn btn-primary wk-step">Next</button>     
        <button type="button" name="btnBackEntry" id="btnBackEntry" value="btnBackEntry" onclick="WelcomePacket.backEntry()" class="btn btn-outline wk-step">Back</button>     
        <button type="button" name="btnSaveEntry" id="btnSaveEntry" value="btnSaveEntry" onclick="WelcomePacket.saveEntry()" class="btn btn-primary wk-step">Add</button>     
      </div>
	  <div class="modal-footer modal-footer-cols d-none entry-confirm-buttons">
        <button type="button" name="btnConfirmEntry" id="btnConfirmEntry" value="btnConfirmEntry" onclick="WelcomePacket.confirmEntry()" class="btn btn-primary wk-step">Confirm</button>     
      </div>
</div></div></div>      
      <div id="dupdlg" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Duplicate Policy Found</h4>
      </div>
      <div class="modal-body">
      	<p>You have previously uploaded the same policy.
      	How would you like to proceed?
      	</p>
      </div>
      <div class="modal-footer" >
      	<button id="btnRemoveDup" type="button" class="btn btn-warning btn-sm" >Discard</button>
      	<button id="btnOverwrite" type="button" class="btn btn-sm btn-success" >Overwrite</button>
      </div>
</div></div></div>

<div id="roofdlg" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Roof Age Warning</h4>
      </div>
      <div class="modal-body">
      	<p class="text-warning">Warning â The Roof Age for this application:  <span id="roofpolicy"></span> 
      	could be a compliance issue!
      	<br>
      		Year Built: <span id="yearBuilt"></span><br> 
      		Year Roof Replaced: <span id="yearRoofReplaced"></span>
      	<br>
      	Update and re-upload application or continue anyways?
      	</p>
      </div>
      <div class="modal-footer" >
      	<button id="btnRemoveRoof" type="button" class="btn btn-warning btn-sm" >Discard</button>
      	<button id="btnContinueRoof" type="button" class="btn btn-sm btn-success" >Continue</button>
      </div>
</div></div></div>

<div id="bindingDocHelp" class="modal  fade" data-backdrop="static">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
      <div class="modal-header mb-4">
        <h4 class="modal-title text-danger">Invalid Binding Doc</h4>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      </div>
      <div class="modal-body">
        <p><i>Whoops</i>! It looks like the binding doc youâve attempted to upload is not saved in the correct format. Please take a second to check the following:</p>

        <p>*Make sure you selected <b>File â Save As</b> when you saved the PDF (File - Print will NOT work)</p>
        <p>*Make sure this is the <b>Original</b> file (no scanned copies, downloaded versions from eAgent, etc will be accepted)</p>

        <p>Double checked the above and still having issues? Chat with one of our AgencyZoom Pros now by clicking the Chat bubble in the bottom right hand corner of your account!</p>

      </div>
      <div class="modal-footer" >
 	     <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
      </div>
</div></div></div>


<div id="quick-start-video" class="modal fade">
  <div class="modal-dialog" style="width: 562px;">
    <div class="modal-content">
      <div class="modal-body" style="padding: 0;height: 316px;">
      	<iframe width="560" height="316" src="about:blank" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>
  </div>
</div>

<div id="sppdlg" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">SPP Warning</h4>
      </div>
      <div class="modal-body">
      	<p class="text-warning">
      	<strong>Warning</strong> - You have an SPP item on this policy. Do you have the appraisal on
      	file or have it uploaded to eAgent?
      	</p>
      </div>
      <div class="modal-footer" >
      	<button id="btnRemoveSPP" type="button" class="btn btn-warning btn-sm spp" > No </button>
      	<button id="btnContinueSPP" type="button" class="btn btn-sm btn-success" > Yes </button>
      </div>
</div></div></div>

<div id="sppdlg-no" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">SPP Warning</h4>
      </div>
      <div class="modal-body">
      	Please go back to alliance and remove the SPP item first as you do not have the appraisal yet.
      </div>
      <div class="modal-footer" >
      	<buttontype="button" data-dismiss="modal"  class="btn btn-default" > Close </button>
      </div>
</div></div></div>

<div id="pipdlg" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">PIP Deductible Compliance Warning</h4>
      </div>
      <div class="modal-body">
      	<p class="text-warning">Warning â The deductible for PIP is over $2500. 
      	<br>
      	Are you sure to continue?
      	</p>
      </div>
      <div class="modal-footer" >
      	<button id="btnRemovePip" type="button" class="btn btn-warning btn-sm" >Discard</button>
      	<button id="btnContinuePip" type="button" class="btn btn-sm btn-success" >Continue</button>
      </div>
</div></div></div>


<div id="shortratedlg" class="modal fade"  data-backdrop="static"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Short Rate Alert</h4>
      </div>
      <div class="modal-body">
      	<p class="text-warning">This policy has at least one car with a Short Rate.
      	<br>
      	Proceed or update your application and reload?
      	</p>
      </div>
      <div class="modal-footer" >
      	<button id="btnRemoveShortRate" type="button" class="btn btn-warning btn-sm" >Discard</button>
      	<button id="btnContinueShortRate" type="button" class="btn btn-sm btn-success" >Continue</button>
      </div>
</div></div></div>




<script type="text/template" id="mergetpl">
<div class="alert alert-warning">
The customer, <%-rc.currentName%> @ <%-rc.currentAddress%> seems to be the same as one of the following.
</div>
<table class="table">
	<thead>
		<tr><th>Name</th><th>Address</th><th></th></tr>
	</thead>
	<% for (var i = 0; i < rc.households.length; i++) { var h = rc.households[i]; %>
	<tr>
		<td><%- h.housename %></td>
		<td><%- h.address1 %>, <%- h.city %>, <%- h.state %></td>
		<td><a data-from="<%-rc.current%>" data-to="<%-h.id%>" href="#" class="btn btn-xs btn-success merge-target"><i class="fas fa-check-circle"></i> Yes</a><span class="text-info" style="display:none;"><i class="fas fa-circle-notch fa-spin"></i> Merging ...</span></td>
	</tr>
	<% }%>
</table>
</script><div id="locdlg" class="modal fade"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Unregistered Location</h4>
      </div>
      <div class="modal-body">
     	       	<p>Agency location is not registered with this account.  Please ask your admin user to register this location.
      	</p>
      	      	<p class="text-primary">
      	Otherwise, if the customer is obtained and written initially by the Customer Care Center, please confirm!
      	</p>
      </div>
      <div class="modal-footer" >
      	<button type="button" class="btn btn-primary pull-left" id="btnCIC">Written by CIC</button>

      	      	<button type="button" class="btn btn-default" id="btnIgnoreLoc">Cancel</button>
      </div>
</div></div></div><div id="mergedlg" class="modal fade"><div class="modal-dialog"><div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Potentially the same customer?</h4>
      </div>
      <div class="modal-body" id="mergecontent">
     	
      </div>
      <div class="modal-footer" >
      	<button type="button" class="btn btn-default" id="btnCancelMerge">Cancel</button>
      </div>
</div></div></div><div id="perioddlg" class="modal fade"><div class="modal-dialog" style="width: 340px;"><div class="modal-content">
      <div class="modal-header mb-4">
          <h4 class="modal-title">Select start/end dates</h4>
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      </div>
      <div class="modal-body" id="periodbody">
      	<label>Start Date</label>
      	<div  class="input-group" style="margin-bottom: 15px;">
            <div id="startDate" class="input-group date" data-target-input="nearest"><input type="text" class="form-control datetimepicker-input" name="startDate" data-target="#startDate" autocomplete="off" placeholder=""><div class="input-group-append" data-target="#startDate" data-toggle="datetimepicker"><div class="input-group-text"><i class="fa fa-calendar"></i></div></div></div>		</div>
		<label>End Date</label>
      	<div  class="input-group">
            <div id="endDate" class="input-group date" data-target-input="nearest"><input type="text" class="form-control datetimepicker-input" name="endDate" data-target="#endDate" autocomplete="off" placeholder=""><div class="input-group-append" data-target="#endDate" data-toggle="datetimepicker"><div class="input-group-text"><i class="fa fa-calendar"></i></div></div></div>		</div>
      </div>
      <div class="modal-footer" >
      	<button id="btnConfirmDates" type="button" class="next btn btn-success" >Confirm</button>
      </div>
</div></div></div>

<div id="monthlyPerioddlg" class="modal fade"><div class="modal-dialog" style="width: 340px;"><div class="modal-content">
      <div class="modal-header mb-4">
          <h4 class="modal-title">Select start/end dates</h4>
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      </div>
      <div class="modal-body">
      	<label>Start Date</label>
      	<div  class="input-group" style="margin-bottom: 15px;">
            <div id="monthlyStartDate" class="input-group date" data-target-input="nearest"><input type="text" class="form-control datetimepicker-input" name="startDate" data-target="#monthlyStartDate" autocomplete="off" placeholder=""><div class="input-group-append" data-target="#monthlyStartDate" data-toggle="datetimepicker"><div class="input-group-text"><i class="fa fa-calendar"></i></div></div></div>		</div>
		<label>End Date</label>
      	<div  class="input-group">
            <div id="monthlyEndDate" class="input-group date" data-target-input="nearest"><input type="text" class="form-control datetimepicker-input" name="endDate" data-target="#monthlyEndDate" autocomplete="off" placeholder=""><div class="input-group-append" data-target="#monthlyEndDate" data-toggle="datetimepicker"><div class="input-group-text"><i class="fa fa-calendar"></i></div></div></div>		</div>
      </div>
      <div class="modal-footer" >
      	<button id="btnConfirmMonthlyDates" type="button" class="next btn btn-success" >Confirm</button>
      </div>
</div></div></div>


<div id="gdlg" data-backdrop="static" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Dialog</h4>
			</div>
			<div class="modal-body">
				<iframe id="gdlgContent" src="" width="100%" seamless frameborder="0" height="525px;"></iframe>
			</div>
		</div>
	</div>
</div>
<a id="kitnowlink" href="javascript:void(0);" class="d-none">Prelaunch</a>
<script src="/js/jquery.iframe-transport.js"></script>
<script src="/js/jquery.uploader.js"></script>
<script>
var isCompanyAdmin = false;
var isLSP = true;
var isOwnerAgent = false;
var myId = 73089; 
var colorDanger = '#FE5252';
var colorMuted = '#bcbcbc'; 
var colorSuccess = '#5cb85c';
var isShowRevenueToAll = false;
$(function() {
    })
</script>
<script>
$(function() {
	$('a.bonus-details').popover({
		cantainer: 'body', 
		content: function() {
			return '<div id="bonus-content-pop">' + $('#bonus-content').html() + '</div>'; 
		},
		template: '<div class="popover popover-sm"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-body no-padding"></div></div>',
		html: true, 
		placement: 'right'
	}).on('shown.bs.popover', function() {
		var loaded = $('#bonus-content').data('loaded'); 
		if (loaded == 0) {
			$('#bonus-content').load('/finance/progress?_t=' + Math.random(), function() {
				$('#bonus-content').data('loaded', '1'); 
				$('#bonus-content-pop').html($('#bonus-content').html()); 
				
				$('a.bonus-details').popover('show'); 
			});
		}
	});  	
}); 
function resetBonusPopover() {
	$('#bonus-content').data('loaded', '0'); 
}
</script>


<script type="text/template" id="bonus-content" data-loaded="0">
<div class="text-center"><i class="fa fa-spin fa-spinner"></i> Loading Comp Info</div>
</script><script>
var summaryData = {}; 
function loadSummaryData(nowinner, noactivity, notask, forceRecalc) {
	var params = {}; 
	if (nowinner) params['nowinner'] = 1; 
	if (noactivity) params['noactivity'] = 1; 
	if (notask) params['notask'] = 1; 
	if (forceRecalc) params['forceRecalc'] = 1;
	$.getJSON('/dashboard/summary-data', params)
	.done(function(data) {
		$.extend(summaryData, data);

        MenuSummaryStat.setTaskLeft(summaryData.taskCounter);
        MenuSummaryStat.setMyComp(summaryData.bonusCounter);
        MenuSummaryStat.populate();

        if (summaryData.showNudge) {
            $('#activity-reminder').removeClass('hidden');
            $('#alerts').removeClass('hidden');
        }

        // I commented out below code as some of the templates are not applicable for new dashboard
        /*
        if (summaryData.winners) {
            $('#winners').removeClass('hidden');
            var template = _.template($( "#trophyBulletin" ).html());
            var html = template(summaryData.winners);

             $('#trophyBulletinContent').html(html);
             transformAvatar('#trophyBulletinContent');
        }
         */
    });
}
function reloadBonus() {
	loadSummaryData(true, true, true, true); 
}
$(function() {
	loadSummaryData(false, false, false, false); 
}); 
</script><script>
var currentBizType = 'written'; 
var salesData = {agents: []};
var writtenDataArray = null; 
var issuedDataArray = null; 
var currentPeriod = 'mtd';
var currentLoc = null; 
var currentLocName = ''; 
var currentAgent = null; 
var currentAgentName = null; 
var currentCarrier = 0; 
var periodShown = false;
var monthlyPeriodShown = false;
var refreshMode = false;
var hasFilter = false;

var GOAL_ITEMS = 'items'; 
var GOAL_PREMIUM = 'premium';
var GOAL_REVENUE = 'revenue';
var GOAL_POINTS = 'points';
var GOAL_AUTO = 'auto';
var GOAL_HOME = 'home';
var GOAL_IPS = 'ips';
var GOAL_APPT = 'appt';
var GOAL_POLICIES = 'policies'; 
var GOAL_BROKERFEES = 'brokerfees'; 
var GOAL_CONDO = 'condo';
var GOAL_BASELINE = 'baseline';
var goalType = GOAL_ITEMS;
var dfltGoalItems = 0;
var secondaryGoalType = GOAL_PREMIUM; 
var dfltGoalPremium = 0;
var hasGoals = true; 
var goalList = null; 
var goalTypes = {
			'items': 'Items',
			'premium': 'Premium',
            'revenue': 'Revenue',
			'points': 'Points',
			'auto': 'Standard Auto',
			'home': 'Home',
			'ips': 'L&H Policies',
			'appt': 'Appointments',
			'policies': 'Policies',
			'brokerfees': 'Broker Fees',
			'condo': 'Condo',
			'baseline': 'Baseline'
};

var chartLabels = null; 
var chartData = null; 

var ITEM = 0, PREMIUM = 1, POLICY=2, POINT=3, AUTO=4, HOME=5, APPT=6, IPS=7, PC=8, COMMISSION=9;
var monthCounters = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
var todayCounters = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;

var currentTab = '#items'; 
var todayStats = {}; 

var itemChart = null, premiumChart = null, policyChart = null, pointChart = null, commissionChart = null;
var analytics1Chart = null, analytics2Chart = null, analytics3Chart = null; 
var issuedItemChart = null, issuedPremiumChart = null, issuedPointChart = null;
var terminationItemChart = null, terminationPremiumChart = null, terminationPolicyChart = null; 
var terminationWrittenItemChart = null, terminationWrittenPremiumChart = null, terminationWrittenPolicyChart = null; 
var bizTypes = {
	'written': 'Written Business', 
	'issued': 'Issued Business', 
	'alr': 'Life & Health',
	'activities': 'Activities',
	'analytics': 'Analytics',
	'terminations': 'Terminations'
}; 

var issuedInit = false;
var alrInit = false; 
var activityInit = false;
var analyticsInit = false;
var currentIssuedMonth = 4; 
var currentIssuedYear = 2017; 
var issuedChartData = null; 
var issuedChartLabels = null; 
var currentIssuedTab = '#issued-premium'; 
var issuedItems = 0, issuedPremium = 0, issuedPoints = 0; 
var currentSort = 'premiumValues';
var currentOrderDesc = true;
var currentActivitySort = 'name';
var currentActivityOrderDesc = false;

var alrData = {agents: []};
var alrCharts = []; 
var activityCharts = []; 
var activityData = null; 
var analyticsCharts = []; 
var analyticsWrittenCharts = []; 
var analyticsIssuedCharts = []; 
var analyticsData = {}; 
var analyticsWrittenData = {}; 
var analyticsIssuedData = {}; 
var salesGoalCharts = []; 
var salesGoalData = {}; 
var analyticsLabels = null; 

var currentAlrTab = '#issued-ips';
var currentActivityTab = '';
var currentAnalyticsTab = '';
var alrSum = [0, 0, 0, 0, 0, 0]; 
var activitySum = []; 
var analyticsSum = []; 
var analyticsType = 'written';

var terminationData = []; 
var terminationChartData = null; 
var terminationWrittenChartData = null; 
var terminationChartLabels = null; 

var pastSales = null; 
var signupBizDays = 0;
var createBizDays = 9;

var todayGoalType = null;
var monthGoalType = null;

$(function() {
	_.templateSettings.variable = "rc"; 	
	
	reloadChart(false); 

	var now = moment().subtract(1, 'month'); 
	
	currentIssuedMonth = now.month() + 1; 
	currentIssuedYear = now.year(); 

	$('#analyticsDropdownList a').on('click', function(e) {
		e.preventDefault(); 
		$('#analytics-label').html($(this).html());
		if($(this).data('type')=='written'){
			analyticsType = 'written';
		}
		else{
			analyticsType = 'writtenAndIssued';
		}
		reloadAnalytics();
	});
	
	$('a.biztype-selector').on('click', function(e) {
		e.preventDefault(); 
		$(this).closest('div.dropdown').removeClass('on');
		var thisBizType = $(this).data('type'); 
		if (thisBizType != currentBizType) {
			$('#' + currentBizType).slideUp();
			currentBizType = thisBizType; 
			$('#biz-type-label').html(getTypeLabel()); 
			$('#' + currentBizType).slideDown();
			$('.dt, #analyticsDropdown').hide();
			$('.agentFilter').show();
			if (currentBizType == 'issued') {
				$('#monthDropdown, #inscoDropdown, #locAgentDropdown').show();
				setLocAgentDropdown();
				if (!issuedInit) {
					reloadIssued(); 
				}
				issuedInit = true;
				
			}
			else if (currentBizType == 'alr') {
				$('#periodDropdown, #locAgentDropdown').show();
				$('#inscoDropdown').hide();
				setLocAgentDropdown();
				if (!alrInit) {
					currentPeriod = 'mtd';
					reloadAlr(); 
					$('.period-label').html('MTD');
				}
// 				alrInit = true; 
			}
			else if (currentBizType == 'activities') {
				$('#periodDropdown').show();
				$('#inscoDropdown, #locAgentDropdown').hide();
				if (!activityInit) {
					currentPeriod = 'yesterday';
					reloadActivity(); 
					$('.period-label').html('Yesterday');
				}
// 				activityInit = true; 
			}
			else if (currentBizType == 'analytics') {
				$('#locAgentDropdown, #analyticsDropdown').show();
				$('#inscoDropdown, #periodDropdown').hide();
				if(!$('.locAgentDropdown.analytics').data('type')){
					currentAgent = 73089;
					currentAgentName = salesData.agents[currentAgent].name;
					setLocationLabelOnly();
				}
				reloadAnalytics(); 
			}
			else if (currentBizType == 'terminations') {
				$('#locAgentDropdown').show();
				$('#inscoDropdown,#periodDropdown').hide();
				if(!$('.locAgentDropdown.terminations').data('type')){
					currentAgent = 73089;
					currentAgentName = salesData.agents[currentAgent].name;
					setLocationLabelOnly();
				}
				$('.agentFilter').hide();
				reloadTermination(false); 
			}
			else {
				currentPeriod = 'mtd';
				reloadChart(false);
				$('.period-label').html('MTD');
				$('#periodDropdown, #inscoDropdown, #locAgentDropdown').show();
				setLocAgentDropdown();
			}
		}		
	}); 
	$('a.period-selector').on('click', function(e) {
		e.preventDefault(); 
		$(this).closest('div.dropdown').removeClass('on');
		var thisPeriod = $(this).data('period'); 
		if (thisPeriod == 'customize') {
			$('#perioddlg').modal({backdrop: 'static', show: true});
		}
		else {
			if (thisPeriod != currentPeriod) {
				$('.period-label').html($(this).html());
				currentPeriod = thisPeriod; 
				switch (currentBizType) {
				case 'written': reloadChart(false); break;
				case 'alr': reloadAlr(); break;
				case 'activities': reloadActivity(); break; 
				case 'terminations': reloadTermination(false);break;
				}
				
			} 
		}
	}); 

	$('a.monthly-period-selector').on('click', function(e) {
		e.preventDefault(); 
		$(this).closest('div.dropdown').removeClass('on');
		$('#monthlyPerioddlg').modal({backdrop: 'static', show: true});
	}); 
	
	$('a.month-selector').on('click', function(e) {
		e.preventDefault(); 
		$(this).closest('div.dropdown').removeClass('on');
		var month = $(this).data('month');
		var year = $(this).data('year');
		if (month != currentIssuedMonth || year != currentIssuedYear) {
			currentIssuedMonth = month; 
			currentIssuedYear = year; 
			$('.month-label').html($(this).html());
			reloadIssued(); 
		}
		
	}) ;
	
	$('#btnConfirmDates').click(function() {
		$('#perioddlg').modal('hide'); 
	    
	    var sd = $("input[name='startDate']").val();
	    var ed = $("input[name='endDate']").val();
	    $('.period-label').html('<small>' +  sd + ' - ' + ed + '</small>') ;
	    currentPeriod = sd + ',' + ed;
	    switch (currentBizType) {
		case 'written': reloadChart(false); break;
		case 'alr': reloadAlr(); break;
		case 'activities': reloadActivity(); break; 
		case 'terminations': reloadTermination(false); break; 
		}
	   
	});

	$('#btnConfirmMonthlyDates').click(function() {
		$('#monthlyPerioddlg').modal('hide'); 
		currentIssuedMonth = '';
	    var sd = $("#monthlyStartDate input[name='startDate']").val();
	    var ed = $("#monthlyEndDate input[name='endDate']").val();
	    $('.month-label').html('<small>' +  sd + ' - ' + ed + '</small>') ;
	    currentPeriod = sd + ',' + ed;
	    reloadIssued();
	});
	
	$('#perioddlg').on('shown.bs.modal', function(e) {
		if (!periodShown) {
			$('.date').datepicker();
			periodShown = true;
		} 
    });	 
  
	$('#monthlyPerioddlg').on('shown.bs.modal', function(e) {
		if (!monthlyPeriodShown) {
			$('.date').datetimepicker({
                viewMode: 'years',
                format: 'MM/YYYY'
            });
			monthlyPeriodShown = true;
		} 
    });
	
	$('#issued-sales-charts').on('show.bs.tab', function(e) {
		currentIssuedTab = $(e.target).attr('href');
		setIssuedDetailLabel(); 
	}); 
	$('#alr-charts').on('show.bs.tab', function(e) {
		currentAlrTab = $(e.target).attr('href'); 
		setAlrLabel(); 
	}); 
	
	$('#activity-charts').on('show.bs.tab', function(e) {
		currentActivityTab = $(e.target).attr('href'); 
		setActivityLabel(); 
	}); 
	
	$('#analytics-charts').on('show.bs.tab', function(e) {
		currentAnalyticsTab = $(e.target).attr('href'); 
	}); 
	
	$('#sales-list table th a').on('click', function(e) {
		e.preventDefault(); 
		var nextSort = $(this).data('sort'); 
		if (currentSort != nextSort) {
			currentSort = nextSort; 
			currentOrderDesc = false;
		}
		else {
			currentOrderDesc = !currentOrderDesc; 
		}
		$('#sales-list table th a').find('i').addClass('fa-sort').removeClass('fa-sort-up fa-sort-down');
		$(this).find('i').removeClass('fa-sort').removeClass(currentOrderDesc? 'fa-sort-up' : 'fa-sort-down').addClass(!currentOrderDesc? 'fa-sort-up' : 'fa-sort-down');

		if ((!isOwnerAgent && !isCompanyAdmin) || currentAgent > 0) {
			populatePolicies();
		} else {
			sortWrittenDataArray();
			populateDetails();
			drawCharts(); 
		}
	}); 

	$('#issued-sales-list table th a').on('click', function(e) {
		e.preventDefault(); 
		var nextSort = $(this).data('sort'); 
		if (currentSort != nextSort) {
			currentSort = nextSort; 
			currentOrderDesc = false;
		}
		else {
			currentOrderDesc = !currentOrderDesc; 
		}
		$('#issued-sales-list table th a').find('i').addClass('fa-sort').removeClass('fa-sort-up fa-sort-down');
		$(this).find('i').removeClass('fa-sort').removeClass(currentOrderDesc? 'fa-sort-up' : 'fa-sort-down').addClass(!currentOrderDesc? 'fa-sort-up' : 'fa-sort-down');
		reloadIssued();
	});

	$('#btnExport').on('click', function(e) {
		var data = [['Name','Items','Premiums','Policies','Points','Auto','Home']];
		for (var i = 0; i < writtenDataArray.length; i++) {
			data.push(transformObjToArr(writtenDataArray[i]));
		}
		exportToCSV('download',data);
	});

	setLocAgentDropdown();

	$('.todayGoalTypeSwitcher').click(function () {
	    todayGoalType = $(this).data('type');
	    setTodayStat();
        setGoalTypeName();
    });

    $('.monthGoalTypeSwitcher').click(function () {
        monthGoalType = $(this).data('type');
        setTodayStat();
        setGoalTypeName();
    });

    $('.hide-db-nav-tabs-main').click(function () {
        $('#sales-charts').addClass('d-none');
    });

    $('.show-db-nav-tabs-main').click(function () {
        $('#sales-charts').removeClass('d-none');
    });
});

function setLocAgentDropdown(){
	if($('.locAgentDropdown').data('type')){
		//$('.locAgentDropdown').show();
	}else {
		//$('.locAgentDropdown').hide();
		currentAgent = null;
		currentAgentName = '';
	}
}

function showSidebar() {
	$('.dashboard').css('marginTop', '0'); 
	$('.sidebar').removeClass('d-none');
}


function hideSidebar() {
	$('.dashboard').css('marginTop', '40px'); 
	$('.sidebar').addClass('d-none');
	$('.sidebar').addClass('d-none');
}

function transformObjToArr(obj){
    var arr = [];
    arr.push(obj['name']);
    arr.push(obj['items']);
    arr.push(obj['premiumValues']);
    arr.push(obj['policies']);
    arr.push(obj['points']);
    arr.push(obj['auto']);
    arr.push(obj['home']);
    return arr;
}

function getTypeLabel() {
	return bizTypes[currentBizType]; 
}

function resetAllFilters() {
	currentPeriod = 'mtd'; 
	$('.period-label').html('MTD');
	
	currentLoc = null; 
	currentAgent= null;

	setLocationLabelOnly(); 
	 
	currentCarrier =  0; 
	$('.carrier-label').html('All Carriers');
}

function reloadChart(resetFilter) {
	var params = '&nogoal=1&noagents=1&nobizdays=1&nobranch=1&noinsco=1'; 
	if (resetFilter) resetAllFilters() ; 

	hasFilter = false; 
	if (currentLoc != null && currentLoc != '') {
		params += ('&loc=' + currentLoc); 
		hasFilter = true; 
	}
	if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
		params += ('&lsp=' + currentAgent); 
		hasFilter = true; 
	}
	if (currentCarrier != 0) {
		params += ('&insco=' + currentCarrier); 
		hasFilter = true; 
	}
	if (currentPeriod != 'mtd') {
		hasFilter = true; 
	}
	$.getJSON('/dashboard/sales-data?period=' + 
			encodeURIComponent(currentPeriod) + (refreshMode? params : ''))
	.done(function(data) {
		$.extend(salesData, data);
		if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
			populatePolicies();	
		}
		
		populateStats();	
		refreshMode = true; 
	});
};	

function reloadTermination(resetFilter) {
	var params = ''; 
	if (resetFilter) resetAllFilters() ; 

	hasFilter = false; 
	if (currentLoc != null && currentLoc != '') {
		params += ('&loc=' + currentLoc); 
		hasFilter = true; 
	}
	if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
		params += ('&lsp=' + currentAgent); 
		hasFilter = true; 
	}
	
	$.getJSON('/dashboard/termination-data?period=' + (refreshMode? params : ''))
	.done(function(data) {
		$.extend(terminationData, data);
		populateTerminationCompare();	
		refreshMode = true; 
	});
};

function populateTerminationCompare() {
	var thisMonth = moment(); 
	thisMonth.date(15); 
	thisMonth.subtract(11, 'months');

	var keys = []; 
	for (var i =  0; i < 12; i++) {
	  	keys.push(thisMonth.format('M/YYYY')); 
		thisMonth.add(1, 'months'); 
	}
	populateTerminationWrittenData(keys);
	populateTerminationData(keys);
	drawTerminationCompareCharts(); 
}

function populateTerminationWrittenData(keys) {
  	terminationWrittenChartData = {items: [], premium: [], policies: []} ;
	terminationChartLabels = []; 
	for (var  i = 0; i < keys.length; i++) {
	  	terminationChartLabels.push(moment(keys[i], "M/YYYY").format("MMM YYYY")); 
		var t = terminationData['writtenStat'][keys[i]]; 
		
		terminationWrittenChartData.items.push(t ? parseInt(t.items) : 0); 	
		terminationWrittenChartData.premium.push(t ? (t.premiums/100).toFixed(0) : 0); 	
		terminationWrittenChartData.policies.push(t ? parseInt(t.policies) : 0);
    }
}

function populateTerminationData(keys) {
  	terminationChartData = {items: [], premium: [], policies: []} ;
	for (var  i = 0; i < keys.length; i++) {
		var t = terminationData['terminationStat'][keys[i]]; 
		
		terminationChartData.items.push(t ? parseInt(t.items) : 0); 	
		terminationChartData.premium.push(t ? parseInt(t.premium) : 0); 	
		terminationChartData.policies.push(t ? parseInt(t.policies) : 0); 	
    }
  
}

function getPastSale(aId) {
	if (signupBizDays > 0 || (createBizDays > 0 && aId==73089)) {
		if (pastSales && pastSales.length > 0) {
			for (var p = 0; p < pastSales.length; p++) {
				if (pastSales[p].id == aId) {
					return pastSales[p];
				} 
			}
		}
	}
	return null; 
}

function shouldProrate() {
	return !(pastSales && pastSales.length > 0); 
}

function isDollarGoalType(goalType) {
    return goalType == GOAL_PREMIUM || goalType == GOAL_BROKERFEES || goalType == GOAL_REVENUE;
}

function calcTodayStats() {
	todayStats = {}; 

	var agencyTodayGoal = 0, agencySecondaryTodayGoal = 0, agencyMonthGoal = 0, agencySecondaryMonthGoal=0;
	var agentKeys = Object.keys(salesData.agents); 
	
	if (salesData.goals) {
		goalType = salesData.goals.primaryMetrics; 
		secondaryGoalType = salesData.goals.secondaryMetrics; 
		goalList = JSON.parse(salesData.goals.goals); 

		for (var i = 0; i < goalList.length; i++) {
			var agentGoal = goalList[i]; 

						var ag = salesData.agents[agentGoal.agent];     
		    if (!ag || ag.salesProducer == '0' || ag.active == '0') continue; 
			    		
		
			var thisP = 0; 
			if (agentGoal.p) {
				thisP = parseInt(agentGoal.p); 
			}
			var thisS = 0; 
			if (agentGoal.s) {
				thisS = parseInt(agentGoal.s) ;
			}
			agencyMonthGoal += thisP; 
			agencySecondaryMonthGoal += thisS; 

			agentPastSale = getPastSale(agentGoal.agent);
			var prorated = (!shouldProrate()) ? 0 : 
				 ((createBizDays > 0 && agentGoal.agent==73089) ? 
						 signupBizDays : signupBizDays
						);
			prorated = 0;
						var calced = thisP * ((salesData.bizdaysPassed + 1) - prorated)/ salesData.bizdaysTotal;
			var calcedS = thisS * ((salesData.bizdaysPassed + 1) - prorated)/ salesData.bizdaysTotal;
			todayStats[agentGoal.agent] = {
                name: getFullName(ag),
                todayGoal: Math.ceil(calced),
                secondaryTodayGoal: Math.ceil(calcedS),
				monthGoal: thisP,
				secondaryMonthGoal: thisS
			};

			agencyTodayGoal += calced;
            agencySecondaryTodayGoal += calcedS;
		}
		agencyTodayGoal = Math.ceil(agencyTodayGoal);
        agencySecondaryTodayGoal = Math.ceil(agencySecondaryTodayGoal);
	}
	else {
		hasGoals = false;
				if (salesData.goals === null || salesData.goals === '') {
			goalType = GOAL_PREMIUM;
			secondaryGoalType = GOAL_POLICIES;
		}
				for (var i = 0; i < agentKeys.length; i++) {
			var k = agentKeys[i]; 
			var a = salesData.agents[k];     
		    if ((a.salesProducer == '1' && a.active == '1') ) {
		    	todayStats[k] = {
                    name: getFullName(a),
		    		todayGoal: Math.ceil(dfltGoalItems * (salesData.bizdaysPassed + 1) / salesData.bizdaysTotal),
                    secondaryTodayGoal: Math.ceil(dfltGoalPremium * (salesData.bizdaysPassed + 1) / salesData.bizdaysTotal),
		    		monthGoal: dfltGoalItems,
		    		secondaryMonthGoal: dfltGoalPremium,
		    	}; 
		    	
		    	
		    	agencyMonthGoal += dfltGoalItems;    
		    	agencySecondaryMonthGoal += dfltGoalPremium;    
		     }
		 }
		agencyTodayGoal = Math.ceil(agencyMonthGoal * (salesData.bizdaysPassed + 1) / salesData.bizdaysTotal);
        agencySecondaryTodayGoal = Math.ceil(agencySecondaryMonthGoal * (salesData.bizdaysPassed + 1) / salesData.bizdaysTotal);
    }
	
	var agencySales = 0, agencyTodaySales = 0, agencySecondaryTodaySales = 0, agencySecondarySales = 0,
        agencyLastSales = 0, agencySecondaryLastSales = 0;

	var todayKeys = Object.keys(todayStats); 
	var firstKey = todayKeys.length  > 0 ? todayKeys[0] : 0; 
    for (var i = 0; i < agentKeys.length; i++) {
    		var k = agentKeys[i]; 
        var a = salesData.agents[k]; 
        var s = salesData.today[k]; 
        var ms = salesData.stats[k];
        var lms = salesData.lastStats[k];
        var sAlr = salesData.todayAlr[k]; 
        var msAlr = salesData.alr[k];
        var lmsAlr = salesData.lastAlr[k];

        var todaySales = 0;
        var secondaryTodaySales = 0;
        var monthSales = 0;
        var lastMonthSales = 0;
        var secondaryMonthSales = 0;
        var secondaryLastMonthSales = 0;
        
        if ((a.salesProducer == '1' && a.active == '1') || s || ms || lms || sAlr || msAlr || lmsAlr) {
        	agentPastSale = getPastSale(k);
        	switch (goalType) {
        		case GOAL_POLICIES: 
        			todaySales += (s? parseInt(s[1]) : 0);
   					monthSales += (ms? parseInt(ms[1]) : 0);
                    lastMonthSales += (lms? parseInt(lms[1]) : 0);
                    break;
	        	case GOAL_ITEMS: 
	        		todaySales += (s? parseInt(s[2]) : 0);
	   				monthSales += (ms? parseInt(ms[2]) : 0);
                    lastMonthSales += (lms? parseInt(lms[2]) : 0);
	            	break;
	        	case GOAL_PREMIUM:
	        		todaySales += (s? parseInt(s[3]) : 0);
	   				monthSales += (ms? parseInt(ms[3]) : 0);
                    lastMonthSales += (lms? parseInt(lms[3]) : 0);
	            	break;
	        	case GOAL_POINTS:
	   				todaySales += (s? parseInt(s[4]) : 0);
	   				monthSales += (ms? parseInt(ms[4]) : 0); 
	   				monthSales += (msAlr? parseInt(msAlr.points) : 0);
                    lastMonthSales += (lms? parseInt(lms[4]) : 0);
                    lastMonthSales += (lmsAlr? parseInt(lmsAlr.points) : 0);
	            	break;
	        	case GOAL_AUTO: 
	        		todaySales += (s? parseInt(s[5]) : 0);
	   				monthSales += (ms? parseInt(ms[5]) : 0);
                    lastMonthSales += (lms? parseInt(lms[5]) : 0);
	            	break;
	        	case GOAL_HOME: 
	        		todaySales += (s? parseInt(s[6]) : 0);
	   				monthSales += (ms? parseInt(ms[6]) : 0);
                    lastMonthSales += (lms? parseInt(lms[6]) : 0);
	            	break;
	        	case GOAL_IPS:
	        		todaySales += (sAlr? parseInt(sAlr.ips) : 0);
	   				monthSales += (msAlr? parseInt(msAlr.ips) : 0);
                    lastMonthSales += (lmsAlr? parseInt(lmsAlr.ips) : 0);
	            	break;
	        	case GOAL_APPT: 
	        		todaySales += (sAlr? parseInt(sAlr.appts) : 0);
	   				monthSales += (msAlr? parseInt(msAlr.appts) : 0);
                    lastMonthSales += (lmsAlr? parseInt(lmsAlr.appts) : 0);
	            	break;
	        	case GOAL_BROKERFEES: 
					todaySales += (s? parseInt(s[9]) : 0);
	   				monthSales += (ms? parseInt(ms[9]) : 0);
                    lastMonthSales += (lms? parseInt(lms[9]) : 0);
	            	break;
                case GOAL_REVENUE:
                    todaySales += (s? parseInt(s[12]) : 0);
                    monthSales += (ms? parseInt(ms[12]) : 0);
                    lastMonthSales += (lms? parseInt(lms[12]) : 0);
                    break;
                case GOAL_CONDO:
                    todaySales += (s? parseInt(s[13]) : 0);
                    monthSales += (ms? parseInt(ms[13]) : 0);
                    lastMonthSales += (lms? parseInt(lms[13]) : 0);
                    break;
                case GOAL_BASELINE:
                    todaySales += (s? parseInt(s[14]) : 0);
                    monthSales += (ms? parseInt(ms[14]) : 0);
                    lastMonthSales += (lms? parseInt(lms[14]) : 0);
                    break;
	   		}
	   		

        	switch (secondaryGoalType) {
        		case GOAL_POLICIES:
                    secondaryTodaySales += (s? parseInt(s[1]) : 0);
        			secondaryMonthSales += (ms? parseInt(ms[1]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[1]) : 0);
                    break;
	        	case GOAL_ITEMS:
                    secondaryTodaySales += (s? parseInt(s[2]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[2]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[2]) : 0);
	            	break;
	        	case GOAL_PREMIUM:
                    secondaryTodaySales += (s? parseInt(s[3]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[3]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[3]) : 0);
	            	break;
	        	case GOAL_POINTS:
                    secondaryTodaySales += (s? parseInt(s[4]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[4]) : 0);
	        		secondaryMonthSales += (msAlr? parseInt(msAlr.points) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[4]) : 0);
                    secondaryLastMonthSales += (lmsAlr? parseInt(lmsAlr.points) : 0);
	            	break;
	        	case GOAL_AUTO:
                    secondaryTodaySales += (s? parseInt(s[5]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[5]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[5]) : 0);
	            	break;
	        	case GOAL_HOME:
                    secondaryTodaySales += (s? parseInt(s[6]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[6]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[6]) : 0);
	            	break;
	        	case GOAL_IPS:
                    secondaryTodaySales += (sAlr? parseInt(sAlr.ips) : 0);
	        		secondaryMonthSales += (msAlr? parseInt(msAlr.ips) : 0);
                    secondaryLastMonthSales += (lmsAlr? parseInt(lmsAlr.ips) : 0);
	            	break;
	        	case GOAL_APPT:
                    secondaryTodaySales += (sAlr? parseInt(sAlr.appts) : 0);
	        		secondaryMonthSales += (msAlr? parseInt(msAlr.appts) : 0);
                    secondaryLastMonthSales += (lmsAlr? parseInt(lmsAlr.appts) : 0);
					break;
				case GOAL_BROKERFEES:
                    secondaryTodaySales += (s? parseInt(s[9]) : 0);
	        		secondaryMonthSales += (ms? parseInt(ms[9]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[9]) : 0);
	            	break;
                case GOAL_REVENUE:
                    secondaryTodaySales += (s? parseInt(s[12]) : 0);
                    secondaryMonthSales += (ms? parseInt(ms[12]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[12]) : 0);
                    break;
                case GOAL_CONDO:
                    secondaryTodaySales += (s? parseInt(s[13]) : 0);
                    secondaryMonthSales += (ms? parseInt(ms[13]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[13]) : 0);
                    break;
                case GOAL_BASELINE:
                    secondaryTodaySales += (s? parseInt(s[14]) : 0);
                    secondaryMonthSales += (ms? parseInt(ms[14]) : 0);
                    secondaryLastMonthSales += (lms? parseInt(lms[14]) : 0);
                    break;
			   }

			var isDollar = isDollarGoalType(goalType);
			var isSecondGoalDollar = isDollarGoalType(secondaryGoalType);
				
	   		if (agentPastSale != null) {
	   			monthSales += (agentPastSale.p * (isDollar? 100 : 1)) ;
	   			secondaryMonthSales += (agentPastSale.s  * (isSecondGoalDollar? 100 : 1)) ;
                lastMonthSales += (agentPastSale.p * (isDollar? 100 : 1)) ;
                secondaryLastMonthSales += (agentPastSale.s  * (isSecondGoalDollar? 100 : 1)) ;
	   		}
        	agencySales += monthSales;
        	agencySecondarySales += secondaryMonthSales;
            agencyLastSales += lastMonthSales;
            agencySecondaryLastSales += secondaryLastMonthSales;
        	agencyTodaySales += todaySales;
        	agencySecondaryTodaySales += secondaryTodaySales;
        	
        	var trending = 0;
        	var secondaryTrending = 0;
        	var todayDiff = 0; 
        	var monthDiff = 0; 
        	var secondaryMonthDiff = 0;
        	
        	if (a.salesProducer == '1' && a.active == '1') {
            	if (!todayStats[k]) {
            		todayStats[k] = {
                            name: getFullName(a),
        		    		todayGoal:  firstKey > 0 ? todayStats[firstKey].todayGoal : 0,
                            secondaryGodayGoal: 0,
        		    		monthGoal: firstKey > 0 ? todayStats[firstKey].monthGoal : 0,
        		    		secondaryMonthGoal: firstKey > 0 ?  todayStats[firstKey].secondaryMonthGoal : 0
        		    }; 
				}

                todayStats[k]['todayGoalDisplay'] = (isDollar? formatDollar(todayStats[k]['todayGoal']) : todayStats[k]['todayGoal']);
                todayStats[k]['monthGoalDisplay'] = (isDollar? formatDollar(todayStats[k]['monthGoal']) : todayStats[k]['monthGoal']);
	    		todayStats[k]['monthSales'] = (isDollar? formatDollar(Math.round(monthSales / 100 )) : monthSales);
	    		todayStats[k]['monthSalesValue'] = isDollar? Math.round(monthSales / 100 ) :  monthSales;
                todayStats[k]['lastMonthSales'] = (isDollar? formatDollar(Math.round(lastMonthSales / 100 )) : lastMonthSales);
                todayStats[k]['lastMonthSalesValue'] = isDollar? Math.round(lastMonthSales / 100 ) :  lastMonthSales;
	    		todayStats[k]['secondarySales'] = (isSecondGoalDollar? formatDollar(Math.round(secondaryMonthSales / 100 )) : secondaryMonthSales);
                todayStats[k]['secondarySalesValue'] = isSecondGoalDollar? Math.round(secondaryMonthSales / 100 ) :  secondaryMonthSales;
                todayStats[k]['secondaryLastSales'] = (isSecondGoalDollar? formatDollar(Math.round(secondaryLastMonthSales / 100 )) : secondaryLastMonthSales);
                todayStats[k]['secondaryLastSalesValue'] = isSecondGoalDollar? Math.round(secondaryLastMonthSales / 100 ) :  secondaryLastMonthSales;
	        	todayStats[k]['todaySales'] = (isDollar? formatDollar(Math.round(todaySales / 100 )) : todaySales);
	        	todayStats[k]['todaySalesValue'] = isDollar? Math.round(todaySales / 100) : todaySales;
	        	todayStats[k]['secondaryTodaySalesValue'] = isSecondGoalDollar? Math.round(secondaryTodaySales / 100) : secondaryTodaySales;
	        	todayDiff = todayStats[k]['todayGoal'] - (isDollar? Math.round(todaySales/100) : todaySales ) ; 
	        	if (todayDiff < 0) {
	        		todayDiff = 0; 
	        	}
	
	        	monthDiff = (isDollar? Math.round(monthSales/100) : monthSales )  -  todayStats[k]['monthGoal']; 
	        	secondaryMonthDiff = (isSecondGoalDollar? Math.round(secondaryMonthSales/100) : secondaryMonthSales )  -  todayStats[k]['secondaryMonthGoal']; 
	        	var todayStartedAt = todayStats[k]['monthSalesValue']; 
	    	    trending = todayStartedAt * salesData.bizdaysTotal / ( salesData.bizdaysPassed + 1);
                var secondaryTodayStartedAt = todayStats[k]['secondarySalesValue'];
                secondaryTrending = secondaryTodayStartedAt * salesData.bizdaysTotal / ( salesData.bizdaysPassed + 1);
	        	todayStats[k]['todayDiff'] = (isDollar? formatDollar( Math.round(todayDiff)) : Math.round(todayDiff)); 
	        	todayStats[k]['todayDiffValue'] = todayDiff; 
	        	todayStats[k]['monthDiff'] = (isDollar? formatDollar( Math.round(monthDiff)) : Math.round(monthDiff)); 
	        	todayStats[k]['secondaryMonthDiff'] = ( isSecondGoalDollar? formatDollar( Math.round(secondaryMonthDiff)) : Math.round(secondaryMonthDiff)); 
   		
	        	todayStats[k]['trending'] = (isDollar? formatDollar( Math.round(trending)) : Math.round(trending));
                todayStats[k]['trendingValue'] = trending;
                todayStats[k]['secondaryTrending'] = (isSecondGoalDollar? formatDollar( Math.round(secondaryTrending)) : Math.round(secondaryTrending));
                todayStats[k]['secondaryTrendingValue'] = secondaryTrending;
                todayStats[k]['down'] = trending < todayStats[k]['monthGoal'];
                todayStats[k]['secondaryDown'] = secondaryTrending < todayStats[k]['secondaryMonthGoal'];
        	}
        	
    	}	
	   		
    }

    if (isDollar) {
		agencySales = Math.round(agencySales / 100);
        agencyLastSales = Math.round(agencyLastSales / 100);
        agencyTodaySales = Math.round(agencyTodaySales / 100);
    }
    if (isSecondGoalDollar) {
    	agencySecondarySales = Math.round(agencySecondarySales / 100);
        agencySecondaryLastSales = Math.round(agencySecondaryLastSales / 100);
    	agencySecondaryTodaySales = Math.round(agencySecondaryTodaySales / 100);
    }
    
    todayDiff = agencyTodayGoal - agencyTodaySales ; 
    if (todayDiff < 0) {
		todayDiff = 0; 
    }
	monthDiff = agencySales - agencyMonthGoal ; 
	secondaryMonthDiff = agencySecondarySales - agencySecondaryMonthGoal ; 
	
	trending = Math.round( (agencySales) * salesData.bizdaysTotal / (salesData.bizdaysPassed + 1) );
	secondaryTrending = Math.round( (agencySecondarySales) * salesData.bizdaysTotal / (salesData.bizdaysPassed + 1) );

    todayStats[0] = {
    		todayGoal: Math.round(agencyTodayGoal),
            secondaryTodayGoal: Math.round(agencySecondaryTodayGoal),
			monthGoal: agencyMonthGoal,
			secondaryMonthGoal: agencySecondaryMonthGoal,

			todaySalesValue: agencyTodaySales,
            secondaryTodaySalesValue: agencySecondaryTodaySales,
			todaySales: (isDollar? formatDollar( agencyTodaySales) : agencyTodaySales),  
			monthSalesValue: agencySales, 
			monthSales:  (isDollar? formatDollar( agencySales) : agencySales),
            lastMonthSalesValue: agencyLastSales,
            lastMonthSales:  (isDollar? formatDollar( agencyLastSales) : agencyLastSales),
            secondarySales: (isSecondGoalDollar? formatDollar( agencySecondarySales) : agencySecondarySales),
            secondarySalesValue: agencySecondarySales,
            secondaryLastSales: (isSecondGoalDollar? formatDollar( agencySecondaryLastSales) : agencySecondaryLastSales),
            secondaryLastSalesValue: agencySecondaryLastSales,
            trending:  (isDollar? formatDollar( trending) : trending),
            trendingValue: trending,
            secondaryTrendingValue: secondaryTrending,
            secondaryTrending: (isSecondGoalDollar? formatDollar( secondaryTrending) : secondaryTrending),
			
			todayDiffValue: todayDiff, 
			todayDiff: (isDollar? formatDollar( todayDiff) : todayDiff),
			monthDiff: (isDollar? formatDollar( monthDiff) : monthDiff),
			secondaryMonthDiff: (isSecondGoalDollar? formatDollar( secondaryMonthDiff) : secondaryMonthDiff),
			down:  trending < agencyMonthGoal,
            secondaryDown: secondaryTrending < agencySecondaryMonthGoal
    };
    
}

function setGoalTypeName() {	
	$('.goal-type').html(goalTypes[goalType]);
}

function setGoalOwner() {
	if (isOwnerAgent || isCompanyAdmin) {
		if (currentAgent == null || currentAgent == 0) {
			$('.goal-owner').html('your agency\'s'); 
			$('.goal-owner2').html('Your agency'); 
		}
		else {
			$('.goal-owner').html(currentAgentName + "' ");
			$('.goal-owner2').html(currentAgentName);
		}
	}
}

function setBreadcrumb() {
    if (isOwnerAgent || isCompanyAdmin) {
        if (currentAgent == null || currentAgent == 0) {
            $('#header-breadcrumb').addClass('d-none');
        }
        else {
            $('#header-breadcrumb').removeClass('d-none').html(currentAgentName);
        }
    }
}

function formatDollar(premium) {
	return '$' + premium.toFixed(0).replace(/(\d)(?=(\d{3})+$)/g, "$1,"); 
}

function getDerivedInfoFromStat(myStat, targetGoalType) {
    var mtdSales, todaySales, todayNeed, todayGoal, monthSales;
    if (goalType == targetGoalType) {
        todaySales = myStat.todaySalesValue;
        monthSales = myStat.monthSalesValue;
        monthGoal = myStat.monthGoal;
        mtdSales = myStat.monthSalesValue - todaySales;
        todayGoal = myStat.todayGoal;
    } else {
        todaySales = myStat.secondaryTodaySalesValue;
        monthSales = myStat.secondarySalesValue;
        monthGoal = myStat.secondaryMonthGoal;
        mtdSales = myStat.secondarySalesValue - todaySales;
        todayGoal = myStat.secondaryTodayGoal;
    }
    todayNeed = todayGoal - mtdSales;

    var todayStill = todayNeed - todaySales;
    if (todayStill < 0) {
        todayStill = 0;
    }
    if (todayNeed < 0) {
        todayNeed = 0;
    }

    var todayAchievedPercent;
    if (todayNeed == 0 || todaySales >= todayNeed) {
        todayAchievedPercent = 100;
    } else {
        todayAchievedPercent = Math.floor((todaySales / todayNeed) * 100);
    }

    var mtdPercent = 100;
    var mtdPercentDisplay = mtdPercent;
    if (myStat.monthGoal > 0) {
        mtdPercentDisplay = mtdPercent = Math.floor((monthSales/monthGoal)*100);
        if (mtdPercent > 100) {
            mtdPercentDisplay = 100;
        }
    }

    var isDollar = isDollarGoalType(targetGoalType);
    return {
        mtdSales: mtdSales,
        todayNeed: todayNeed,
        todayNeedDisplay: isDollar ? formatDollar(todayNeed) : todayNeed,
        todayStill: todayStill,
        todayStillDisplay: isDollar ? formatDollar(todayStill) : todayStill,
        todaySales: todaySales,
        todaySalesDisplay: isDollar ? formatDollar(todaySales) : todaySales,
        todayGoal: todayGoal,
        todayAchievedPercent: todayAchievedPercent,
        mtdPercentDisplay: mtdPercentDisplay,
        mtdPercent: mtdPercent,
    };
}

function setTodayStat() {
    var myStat;
	if (isOwnerAgent || isCompanyAdmin) {
		if (currentAgent == null || currentAgent == 0) {
			myStat = todayStats[0]; 
		}
		else {
			myStat = todayStats[currentAgent]; 
		}
	}
	else {
		myStat = todayStats[myId]; 
	}

	if (!myStat) {
		myStat = { monthSalesValue: 0, todaySalesValue: 0, todayGoal: 0,  monthGoal: 0, 
					secondarySales: 0, secondaryMonthGoal: 0, secondaryMonthDiff: 0, 
					trending: 0, secondaryTrending: 0, down:false, secondaryDown: false, secondaryTodaySalesValue: 0,
                    secondaryTodayGoal: 0 };
	}
	if (myStat) {
	    todayGoalType = todayGoalType || goalType;
        var derived = getDerivedInfoFromStat(myStat, todayGoalType);
        var isTodayGoalDollar = isDollarGoalType(todayGoalType);
		$('#achievedToday').html(isTodayGoalDollar? formatDollar(derived.todaySales) : derived.todaySales);
		$('.mtd-sales').html(isTodayGoalDollar? formatDollar(derived.mtdSales) : derived.mtdSales);
		$('.mtd-goals').html(isTodayGoalDollar? formatDollar(derived.todayGoal) : derived.todayGoal);
		$('.today-goal').html(isTodayGoalDollar? formatDollar(derived.todayNeed) : derived.todayNeed);

		var htm = isTodayGoalDollar? formatDollar(derived.todayStill) : derived.todayStill;
		todayDiff = htm;        // updates the _gamma_today_goal_stats.php
        todaySalesPercent = derived.todayNeed > 0 ? (derived.todaySales / derived.todayNeed) * 100 : 100;
		
		createTodayDiffChart([Math.round(derived.todayStill), Math.round(derived.todaySales)]);

		$('.month-diff').html( myStat.monthDiff);
        var isSecondaryGoalDollar = isDollarGoalType(secondaryGoalType);
		$('.secondary-month-goal').html(isSecondaryGoalDollar? formatDollar(myStat.secondaryMonthGoal) : myStat.secondaryMonthGoal);
		$('.secondary-month-diff').html( myStat.secondaryMonthDiff);
		$('#trending-card').toggleClass('down', myStat.down);   // ....
		$('.primaryType').html(goalTypes[goalType]).data('type', goalType);
		$('.secondaryType').html(goalTypes[secondaryGoalType]).data('type', secondaryGoalType);

        var getIncreasePercent = function (num, deno) {
            if (deno > 0) {
                return (((num - deno) / deno) * 100).toFixed(1);
            } else {
                return false;
            }
        };

        var renderVsLastMonthDown = function (down) {
            if (down) {
                $('.vs-last-month i').addClass('fa-arrow-down').removeClass('fa-arrow-up').css('color', '#ed0a4a');
            } else {
                $('.vs-last-month i').addClass('fa-arrow-up').removeClass('fa-arrow-down').css('color', '');
            }
        };

        var renderTrendingDownColor = function (down) {
            if (down) {
                $('#trending-for-progress').css('background', '');
            } else {
                $('#trending-for-progress').css('background', '#2eff9f');
            }
        };

        monthGoalType = monthGoalType || goalType;
        var showMonthPrimaryGoal = monthGoalType === goalType;
        if (showMonthPrimaryGoal) {
            var trendingPercent = '100%';
            var trendingAbsPercent = '100%';
            if (myStat.monthGoal > 0) {
                trendingPercent = Math.round((Math.abs(myStat.monthGoal - myStat.trendingValue) / myStat.monthGoal) * 100) + '%';
                trendingAbsPercent = Math.round((myStat.trendingValue / myStat.monthGoal) * 100) + '%';
            }
            $('.trending-number').html(myStat.trending);
            $('.month-goal').html(isDollarGoalType(goalType)? formatDollar(myStat.monthGoal) : myStat.monthGoal);
            $('.trending-percent').html(trendingPercent);
            $('#trending-for-progress').css('width', '100%');
            $('.trending-above').html(myStat.down ? 'below' : 'above');
            renderTrendingDownColor(myStat.down);

            var monthSalesPercent = '100%';
            if (myStat.monthGoal > 0) {
                monthSalesPercent = Math.round((myStat.monthSalesValue / myStat.monthGoal) * 100) + '%';
            }
            $('.month-premiums-percent').html(monthSalesPercent);
            $('#month-currently-at .progress-bar em').css('width', monthSalesPercent);
            $('.month-premiums').html(myStat.monthSales);
            $('#last-month-sales').html(myStat.lastMonthSales);

            var vsLastMonthSalesDown = false;
            var vsLastMonthSalesPercent = getIncreasePercent(myStat.trendingValue, myStat.lastMonthSalesValue);
            if (vsLastMonthSalesPercent < 0) {
                vsLastMonthSalesDown = true;
            }
            $('#vs-last-month-sales-percent').html(vsLastMonthSalesPercent === false ? 'N/A'
                : Math.abs(vsLastMonthSalesPercent) + '%');
            renderVsLastMonthDown(vsLastMonthSalesDown);
        }
        else {
            var secondaryTrendingPercent = '100%';
            var secondaryTrendingAbsPercent = '100%';
            if (myStat.secondaryMonthGoal > 0) {
                secondaryTrendingPercent = Math.round((Math.abs(myStat.secondaryMonthGoal - myStat.secondaryTrendingValue) / myStat.secondaryMonthGoal) * 100) + '%';
                secondaryTrendingAbsPercent = Math.round((myStat.secondaryTrendingValue / myStat.secondaryMonthGoal) * 100) + '%';
            }
            $('.trending-number').html(myStat.secondaryTrending);
            $('.month-goal').html(isDollarGoalType(secondaryGoalType)? formatDollar(myStat.secondaryMonthGoal) : myStat.secondaryMonthGoal);
            $('.trending-percent').html(secondaryTrendingPercent);
            $('#trending-for-progress').css('width', '100%');
            $('.trending-above').html(myStat.secondaryDown ? 'below' : 'above');
            $('.month-premiums').html(myStat.secondarySales);
            renderTrendingDownColor(myStat.secondaryDown);

            var secondarySalesPercent = '100%';
            if (myStat.secondaryMonthGoal > 0) {
                secondarySalesPercent = Math.round((myStat.secondarySalesValue / myStat.secondaryMonthGoal) * 100) + '%';
            }
            $('.month-premiums-percent').html(secondarySalesPercent);
            $('#month-currently-at .progress-bar em').css('width', secondarySalesPercent);
            $('#last-month-sales').html(myStat.secondaryLastSales);

            var secondaryVsLastMonthSalesDown = false;
            var secondaryVsLastMonthSalesPercent = getIncreasePercent(myStat.secondaryTrendingValue, myStat.secondaryLastSalesValue);
            if (secondaryVsLastMonthSalesPercent < 0) {
                secondaryVsLastMonthSalesDown = true;
            }
            $('#vs-last-month-sales-percent').html(secondaryVsLastMonthSalesPercent === false ? 'N/A'
                : Math.abs(secondaryVsLastMonthSalesPercent) + '%');
            renderVsLastMonthDown(secondaryVsLastMonthSalesDown);
        }

        if (salesData.folio) {
			var start = moment(salesData.folio[2]);
			var end = moment(salesData.folio[3]);
			$('span.folioDate').html(start.format('MMM DD') + " - " + end.format('MMM DD')); 
		}
	}
}

function populateToday() {
	calcTodayStats(); 
	setGoalTypeName(); 
	setGoalOwner(); 
	setTodayStat();
}

function setDetailLabel() {
	$('#sales-charts ul li:nth-child(1) a span').html(monthCounters[ITEM]);
	$('#sales-charts ul li:nth-child(2) a span').html(formatDollar(Math.round(monthCounters[PREMIUM] / 100)));
    $('#sales-charts ul li:nth-child(3) a span').html(monthCounters[POLICY]);
        $('#sales-charts ul li:nth-child(4) a span').html(monthCounters[POINT]);
    }

function setupDropdowns() {
	var locHtml = '<li><a class="dropdown-item" href="javascript:selectLoc( \'\',\'\')">All Locations</a></li>';
	for (var i = 0; i < salesData.branches.length; i++) {
		var loc = salesData.branches[i]; 
					var locName = salesData.branchNames[i];
			locHtml += ('<li><a class="dropdown-item" href="javascript:selectLoc(\'' + loc + '\',\'' + locName + '\')">' + escapeHtml(locName) + '</a></li>');
			}
	
	locHtml += '<li class="dropdown-divider agentFilter"></li>';
	locHtml += ('<li class="agentFilter"><a class="dropdown-item" href="javascript:selectAgent(\'0\')">All Agents</a></li>');
    var agentKeys = Object.keys(salesData.agents); 
    for (var i = 0; i < agentKeys.length; i++) {
        var k = agentKeys[i]; 
        var a = salesData.agents[k]; 
        if ((a.salesProducer == '1' && a.active == '1') ) {
        	locHtml += ('<li class="agentFilter"><a class="dropdown-item" href="javascript:selectAgent(\'' + a.id + '\')">' + escapeHtml(a.name) + '</a></li>');
        }
    }
	
	$('.locDropdown').html(locHtml);

	var coHtml = '<li><a class="dropdown-item" href="javascript:selectCarrier( \'0\')">All Carriers</a></li>';
    var inscoKeys = Object.keys(salesData.inscos); 
    for (var i = 0; i < inscoKeys.length; i++) {
        var k = inscoKeys[i]; 
        coHtml += ('<li><a class="dropdown-item" href="javascript:selectCarrier(\'' + k + '\')">' + salesData.inscos[k] + '</a></li>');
    }

    if (salesData.goals) {
        var metrics = salesData.goals.primaryMetrics;
        if (metrics == 'revenue' && !isShowRevenueToAll) {
            metrics = 'policies';
        }

	    switch (metrics) {
	    case 'premium': $('#sales-charts li:nth-child(2) a').tab('show');  break;
	    case 'policies': $('#sales-charts li:nth-child(3) a').tab('show');  break;
        case 'revenue': $('#sales-charts li:nth-child(4) a').tab('show');  break;
	    case 'points': $('#sales-charts li:nth-child(5) a').tab('show'); break;
	    }
    }
    $('.carrierDropdown').html(coHtml);
    }

function addToSales(counter, stat) {
	if (stat) {
		counter[POLICY] += parseInt(stat[1]);
		counter[ITEM] += parseInt(stat[2]); 
		counter[PREMIUM] +=  parseInt(stat[3]); 
		counter[POINT] +=  parseInt(stat[4]); 
		counter[AUTO] +=  parseInt(stat[5]); 
		counter[HOME] +=  parseInt(stat[6]);
		counter[COMMISSION] += parseInt(stat[12]);

		if (stat.length > 10) {
			counter[POINT] -=  parseInt(stat[10]); 
		}
	}
}

function addToAlr(counter, alr) {
	if (alr) {
		counter[IPS] +=  parseInt(alr.ipt);
		counter[APPT] +=  parseInt(alr.appts);  
		counter[PC] +=  parseInt(alr.credits); 
		 if (currentCarrier == 0 || currentCarrier == 1) {
			counter[POINT] +=  parseInt(alr.points);
		 }
	}
}

function populateStats() {
	if (!refreshMode) {
		setupDropdowns();
		if (salesData.goals) {
			currentSort = salesData.goals.primaryMetrics == 'premium' ? 'premiumValues' : salesData.goals.primaryMetrics;  
		}   
	}
	monthCounters = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
	todayCounters = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
	
	var agentKeys = Object.keys(salesData.agents); 
    for (var i = 0; i < agentKeys.length; i++) {
        var a = agentKeys[i]; 
		if (isCompanyAdmin || isOwnerAgent || myId == a ) {
			addToSales(todayCounters, salesData.today[a]);	
			
			addToAlr(todayCounters, salesData.todayAlr[a]);
		}
		addToSales(monthCounters, salesData.stats[a]);
		addToAlr(monthCounters, salesData.alr[a]);		
    }

	if (!hasFilter) {
		populateToday(); 
		goalPromptIfNeeded(); 
	}

	buildWrittenDataArray(monthCounters);
	setDetailLabel(); 
	sortWrittenDataArray();
	populateDetails();
	drawCharts();
	
	if (!isCompanyAdmin && !isOwnerAgent) {
		populatePolicies();
	}
	}

function selectLoc(loc,locName) {
	currentLoc = loc; 
	currentLocName = locName.length > 15 ? locName.substr(0,15) + '...' : locName;; 
	setLocationLabel(); 
}


function selectAgent(a) {
	var prevAgent = currentAgent;
	currentAgent = a; 
	if (currentAgent > 0) {
		currentAgentName = salesData.agents[currentAgent].name; 

		var params = '&nogoal=1&noagents=1&nobizdays=1&nobranch=1&noinsco=1'; 

		hasFilter = false; 
		if (currentLoc != null && currentLoc != '') {
			params += ('&loc=' + currentLoc); 
			hasFilter = true; 
		}
		if (currentAgent != null && currentAgent != ''&& currentAgent != 0) {
			params += ('&lsp=' + currentAgent); 
			hasFilter = true; 
		}
		if (currentCarrier != 0) {
			params += ('&insco=' + currentCarrier); 
			hasFilter = true; 
		}
		if (currentPeriod != 'mtd') {
			hasFilter = true; 
		}
		
        if (currentBizType != 'written') { // when == load duplicate with line 456
            $.getJSON('/dashboard/sales-data?period=' +
                encodeURIComponent(currentPeriod) + (refreshMode? params : ''))
                .done(function(data) {
                    $.extend(salesData, data);
                    populatePolicies();
                });
        }

		$('#written-navbar').css('visibility', 'hidden');
        $('.written-tab-pane').removeClass('active');
        $('#lsp-policies').addClass('active');
	}	else {
        $('#written-navbar').css('visibility', 'visible');
        var activeTabSelector = $('.written-nav-link.active').attr('href');
        $(activeTabSelector).addClass('active');
		$('#lsp-policies').removeClass('active');
	}

	if (prevAgent != currentAgent && currentBizType == 'written') {
		setGoalOwner();
        setBreadcrumb();
		setTodayStat();
	}
	
	setLocationLabel(); 
}

function selectCarrier(c) {
	currentCarrier = c; 
	var html = ''; 
	if (currentCarrier == 0) {
		html = 'All Carriers'; 
	}
	else {
		html = salesData.inscos[currentCarrier]; 
	}
	$('.carrier-label').html(html);
	
	refreshCurrent(); 
}

function setLocationLabelOnly() {
	var html = ((currentLoc == null || currentLoc == '') ? 'All Locations' : currentLocName) + ' - ' + 
				((currentAgent == null || currentAgent == 0) ? 'All Agents' : currentAgentName); 
	$('.location-label').html(html);
}

function setLocationLabel() {
	setLocationLabelOnly(); 
	refreshCurrent();
}

function refreshCurrent() {
	switch (currentBizType) {
	case 'written':
		reloadChart(false); break;
	case 'issued': 
		reloadIssued(); break;
	case 'alr': 
		reloadAlr(); break;
	case 'activities': 
		reloadActivity(); break; 
	case 'analytics': 
		reloadAnalytics(); break; 
	case 'terminations': 
		reloadTermination(); break; 
	}
}

function drawCharts() {
	if (itemChart) itemChart.destroy(); 
	if (premiumChart) premiumChart.destroy(); 
	if (policyChart) policyChart.destroy(); 
	if (pointChart) pointChart.destroy();
    if (commissionChart) commissionChart.destroy();

    itemChart = drawChart(chartData.items, 'item-chart', chartLabels, 'Items');
	premiumChart = drawChart(chartData.premiums, 'premium-chart', chartLabels, 'Premium'); 
	policyChart = drawChart(chartData.policies, 'policy-chart', chartLabels, 'Policies'); 
	pointChart = drawChart(chartData.points, 'point-chart',chartLabels, 'Points');
    if (isShowRevenueToAll) {
        commissionChart = drawChart(chartData.commissions, 'commission-chart',chartLabels, 'Revenue');
    }
}

function destroyAnalyticsCharts(){
	if (analytics1Chart) analytics1Chart.destroy();
	if (analytics2Chart) analytics2Chart.destroy(); 
	if (analytics3Chart) analytics3Chart.destroy(); 
}

function drawAnalyticsCharts() {
	destroyAnalyticsCharts();
	analytics1Chart = drawAnalyticsChart(analyticsCharts.primarys, salesGoalCharts.primaryGoals, 'analytics-1-chart', goalTypes[goalType]);
	analytics2Chart = drawAnalyticsChart(analyticsCharts.secondarys, salesGoalCharts.secondaryGoals, 'analytics-2-chart', goalTypes[secondaryGoalType]);
	analytics3Chart = null;
}

function drawAnalyticsChart(writtens, goalData, container, tabName) {
	
	var bar = null;
	if(goalData != null) {
		bar = {backgroundColor:[],borderColor:[]};
		for(var i=0;i<writtens.length;i++) {
			if(writtens[i] >= goalData[i]) {
				bar.backgroundColor.push('rgba(0,163,0, 0.2)');
				bar.borderColor.push('rgba(0,163,0, 1)')
			} else {
				bar.backgroundColor.push('rgba(255, 99, 132, 0.2)');
				bar.borderColor.push('rgba(255, 99, 132, 1)');
			}
		}
	}
	return drawTrendingChart(writtens, goalData, container, analyticsLabels, tabName, bar); 
}


function drawAnalyticsCompareCharts() {
	destroyAnalyticsCharts();	
	$('#analytics-charts ul li:last-child').show(); 
	$('#analytics-charts ul li:first-child a').html('Items');
	$('#analytics-charts ul li:nth-child(2) a').html('Premium'); 
	$('#analytics-charts ul li:nth-child(3) a').html('Points');
	$('#analytics-charts ul li a, #analytics-charts div.tab-content .tab-pane').removeClass('active');
	$('#analytics-charts ul li:first-child a, #analytics-charts div.tab-content .tab-pane:first-child').addClass('active');

	analytics1Chart = doDrawCompareChart(analyticsWrittenCharts.items, analyticsIssuedCharts.items, 'analytics-1-chart', analyticsLabels, 'Items', 'Written', 'Issued'); 
	analytics2Chart = doDrawCompareChart(analyticsWrittenCharts.premium, analyticsIssuedCharts.premium, 'analytics-2-chart', analyticsLabels, 'Premium', 'Written', 'Issued'); 
	analytics3Chart = doDrawCompareChart(analyticsWrittenCharts.points, analyticsIssuedCharts.points,'analytics-3-chart',analyticsLabels, 'Points', 'Written', 'Issued'); 
	$('#analyticsPointTab').hide(); 
}

function drawTrendingChart(currentData, goalData, container, labels, tabName, bar) {
	return doDrawChart(currentData, goalData, container, labels, tabName, true, bar); 
}
function drawChart(currentData, container, labels, tabName) {
    var chartData = sortChartData(currentData, labels);
	return doDrawChart(chartData.sortedChartData, null, container, chartData.sortedLabels, tabName, false, null); 
}
function doDrawChart(currentData, goalData, container, labels, tabName, withLine, bar) {
	var ctx = document.getElementById(container);
    if (!ctx) {
        // allstate doesn't show the 3rd chart for analytics.
        return null;
    }
/*
	var series, type;
	if (withLine) {
        type = 'line';
	    series = [{
            type: 'line',
            name: tabName + ' Goal',
            data: goalData
        }, {
            type: 'column',
            name: tabName,
            data: currentData
        }];
	} else {
        type = 'bar';
        series = [{
            name: tabName,
            data: currentData
        }];
	}
*/

    var series;
    if (withLine) {
        series = [{
            name: tabName,
            data: currentData
        }, {
            name: tabName + ' Goal',
            data: goalData
        }];
    } else {
        series = [{
            name: tabName,
            data: currentData
        }];
    }

    var availableColors = ['#2eff9f', '#3c7ef3', '#93b9fb', '#71839b'];
    var fillColors = [];
    for (var i = 0; i < currentData.length; i++) {
        if (availableColors[i]) {
            fillColors.push(availableColors[i]);
        } else {
            fillColors.push('#a4a7aa');
        }
    }
    var optionsCols = {
        chart: {
            height: 400,
            type: 'bar',
            toolbar: {
                show: false
            }
        },
        //colors: colors,
        plotOptions: {
            bar: {
                columnWidth: '70%',
                distributed: true,
            }
        },
        dataLabels: {
            enabled: false,
        },
        series: series,
        fill: {
            colors: fillColors,
        },
        xaxis: {
            categories: labels,
            labels: {
                style: {
                    fontSize: '14px'
                }
            }
        },
        yaxis: {
            min: 0
        },
        legend: {
            show: true,
            markers: {
                fillColors: fillColors
            }
        }
    };

    var chart = new ApexCharts(
        ctx,
        optionsCols
    );
    chart.render();
	return chart; 
}

function doDrawCompareChart(firstData,secondData, container, labels, tabName, barLabel1, barLabel2) {
    var ctx = document.getElementById(container);
    if (!ctx) {
        // allstate doesn't show the 3rd chart for analytics.
        return null;
    }

    /*
	var options = {

		 tooltips: {
	            mode: 'index',
	            intersect: false,
	            bodySpacing: 10,
	            xPadding: 10,
	            titleMarginBottom: 12,
	            titleFontSize: 14,
	            yPadding: 10,
	            backgroundColor: "rgba(0, 0, 0, 0.6)"
	     },

		"maintainAspectRatio": false,
		legend: {
            display: true
        },
        "scales": {
            xAxes: [{
				gridLines: {
                	display:false
            	} ,
				ticks: {
					autoSkip: false
				}
            }],
            "yAxes": [{
                "ticks": {
                    "beginAtZero": true
                }
            }]
        }
    };
    var barData1 = {
            "label": barLabel1,
            "data": firstData,
            "fill": false,
            "backgroundColor": "rgba(54, 162, 235, 0.2)",
            "borderColor":  "rgba(54, 162, 235, 1)",
            "borderWidth": 1,
    };

    var barData2 = {
            "label": barLabel2,
            "data": secondData,
            "fill": false,
            "backgroundColor": "rgba(255, 99, 132, 0.2)",
            "borderColor":  "rgba(255,99,132,1)",


            "borderWidth": 1,
    }; */

    var colors = ["rgba(54, 162, 235, 0.2)", "rgba(255, 99, 132, 0.2)"];
    var optionsCols = {
        chart: {
            height: 400,
            type: 'bar',
            toolbar: {
                show: false
            }
        },
        colors: colors,
        plotOptions: {
            bar: {
                columnWidth: '70%',
            }
        },
        dataLabels: {
            enabled: false,
        },
        series: [{
            name: barLabel1,
            data: firstData,
        }, {
            name: barLabel2,
            data: secondData,
        }],
        xaxis: {
            categories: labels,
            labels: {
                style: {
                    fontSize: '14px'
                }
            }
        },
        yaxis: {
            min: 0
        }
    };

    var chart = new ApexCharts(
        ctx,
        optionsCols
    );
    chart.render();
    return chart;
}


function getShortName(a) {
	return a.firstname + ' ' + a.lastname.substring(0, 1); 
}
function getFullName(a) {
    return a.firstname + ' ' + a.lastname;
}

function buildWrittenDataArray(monthCounters) {
	writtenDataArray = []; 
	var agentKeys = Object.keys(salesData.agents); 
    for (var i = 0; i < agentKeys.length; i++) {
    	var k = agentKeys[i]; 
        var a = salesData.agents[k]; 
        var ms = salesData.stats[k];
        var lh = salesData.alr[k];
                if ((a.salesProducer == '1' && a.active == '1') || ms ) {
        			var rowData = {
				id: k, 
				name: getShortName(a), 
				items: (ms ? ms[2] : 0), 
				premiums: (ms ? formatDollar( Math.round(ms[3] / 100)) : 0),
				premiumValues: (ms ? Math.round(ms[3] / 100) : 0),
				policies: (ms ? ms[1] : 0), 
				points: (ms ? ms[4] : 0), 
				auto: (ms ? ms[5] : 0), 
				home: (ms ? ms[6] : 0),
                commissionValues: (ms ? Math.round(ms[12] / 100) : 0),
                commission: (ms ? formatDollar( Math.round(ms[12] / 100)) : 0),
			}; 
			if (lh && (currentCarrier == 0 || currentCarrier == 1)) {
				rowData.points += (lh.points ? parseInt(lh.points) : 0);
			}
			if (ms && ms.length > 10) {
				rowData.points -= (parseInt(ms[10]));
			}
						writtenDataArray.push(rowData);
        }
    }
}

function sortWrittenDataArray() {
	writtenDataArray.sort(function(o1, o2) {
		var cmp = 0; 
		switch (currentSort) {
		case 'name': cmp = o1.name.localeCompare(o2.name); break; 
		case 'items': cmp = o1.items -o2.items; break; 
		case 'premiumValues': cmp = o1.premiumValues -o2.premiumValues; break; 
		case 'policies': cmp = o1.policies -o2.policies; break; 
		case 'points': cmp = o1.points -o2.points; break;
		case 'auto': cmp = o1.auto -o2.auto; break;
		case 'home': cmp = o1.home -o2.home; break;
        case 'commissionValues': cmp = o1.commissionValues -o2.commissionValues; break;
            default : cmp = o1.premiumValues -o2.premiumValues; break;
		}
					return 0 - cmp;
				return currentOrderDesc? (0 - cmp) : cmp; 
	});
}

function populateDetails() {
	$('#sales-detail-body').html('') ;
	chartLabels = [] ;
	
	var  t = _.template($( "#tmplDetail" ).html());
	chartData = {items: [], policies: [], points: [], premiums: []} ;

	if (isShowRevenueToAll) {
        chartData['commissions'] = [];
	}

	for (var i = 0; i < writtenDataArray.length; i++) {
		var d = writtenDataArray[i];
		if (isCompanyAdmin || isOwnerAgent) {
			var htm = t(d);
    		$('#sales-detail-body').append(htm);
        }
    	
    	chartLabels.push(d['name']); 
    	chartData.policies.push(d['policies']); 	
    	chartData.items.push(d['items']); 	
    	chartData.premiums.push(d['premiumValues']); 	
    	chartData.points.push(d['points']);
        if (isShowRevenueToAll) {
            chartData.commissions.push(d['commissionValues']);
        }
    }
	transformAvatar('#sales-detail-body');

    $('#month-goal-body').html('') ;
    $('#today-goal-body').html('') ;
    var todayGoalT = _.template($( "#tmplTodayGoal" ).html());
    var monthGoalT = _.template($( "#tmplMonthGoal" ).html());
    for (var agentId in todayStats) {
        if (agentId == 0) continue;
        var d = todayStats[agentId];
        if (isCompanyAdmin || isOwnerAgent) {
            var derived = getDerivedInfoFromStat(d, goalType);
            var extended = $.extend({}, d, {agentId: agentId}, derived);
            $('#month-goal-body').append(monthGoalT(extended));
            $('#today-goal-body').append(todayGoalT(extended));
        }
    }
}


function populatePolicies() {
	_.templateSettings.variable = "rc"; 	
	var myItems = 0, myPremiums = 0, myPolicies = 0, myPoints = 0, myRevenue = 0;
	var targetAgent = currentAgent; 
	if (!isOwnerAgent && !isCompanyAdmin) {
		targetAgent = 73089;
	}
		
	if (salesData.stats && salesData.stats[targetAgent]) {
		 var ms = salesData.stats[targetAgent]; 

		 var myAlrPoints = 0;
		 if (salesData.alr && salesData.alr[targetAgent]) {
			myAlrStat = salesData.alr[targetAgent];  
			myAlrPoints = parseInt(myAlrStat.points);
		 }

		 myItems = parseInt(ms[2]);  
		 myPremiums = parseInt(ms[3]); 
		 myPolicies = parseInt(ms[1]); 
		 myPoints =  parseInt(ms[4]) + myAlrPoints;
		 myRevenue = parseInt(ms[12]);
	}
	var myCounters = [myItems, myPremiums, myPolicies, myPoints, myRevenue];
 
 	myCounters[1] /= 100;
    myCounters[4] /= 100;
 	myPremiums = '$' + myCounters[1].toFixed(0).replace(/(\d)(?=(\d{3})+$)/g, "$1,")
    myRevenue = '$' + myCounters[4].toFixed(0).replace(/(\d)(?=(\d{3})+$)/g, "$1,")
    $('#my-items').html(myCounters[0]); 
    $('#my-policies').html(myCounters[2]); 
    $('#my-premiums').html(myPremiums); 
    $('#my-points').html(myCounters[3]);
    $('#my-revenue').html(myRevenue);
    sortPoliciesDataArray();
    populatePolicyStatsTable();
}

function sortPoliciesDataArray() {
	salesData.policies.sort(function(o1, o2) {
		var cmp = 0; 
		switch (currentSort) {
		case 'housename': cmp = o1.housename.localeCompare(o2.housename); break; 
		case 'premiumValues': cmp = o1.premium -o2.premium; break;
        case 'commissionValues': cmp = o1.commission -o2.commission; break;
		case 'policy': cmp = o1.insTypeName.localeCompare(o2.insTypeName); break;
		case 'date': cmp = new Date(o1.signedDate) -new Date(o2.signedDate); break;
		}
		return currentOrderDesc? (0 - cmp) : cmp; 
	});
}

function populatePolicyStatsTable(){
	$('.written-policies #sales-detail-body').html('') ;
	var  t = _.template($( "#tmplPolicy" ).html());
    for (var i = 0; i < salesData.policies.length; i++) {
		var d = salesData.policies[i];
		var htm = t(d);
		$('.written-policies #sales-detail-body').append(htm);
    }
}

function reloadIssued() {
	var params = ''; 

	if (currentIssuedMonth != null && currentIssuedMonth != '') {
		params += ('month=' + currentIssuedMonth + '&year=' + currentIssuedYear); 
	} else {
		params += ('period=' + encodeURIComponent(currentPeriod)); 
	}
	if (currentLoc != null && currentLoc != '') {
		params += ('&loc=' + currentLoc); 
	}
	if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
		params += ('&lsp=' + currentAgent); 
	}
	if (currentCarrier != 0) {
		params += ('&insco=' + currentCarrier); 
	}
	$.getJSON('/dashboard/issued-data?' + params)
	.done(function(data) {
		populateIssuedStats(data);	
	});
}



function drawIssuedCharts() {
	if (issuedItemChart) issuedItemChart.destroy(); 
	if (issuedPremiumChart) issuedPremiumChart.destroy(); 
	if (issuedPointChart) issuedPointChart.destroy(); 

	issuedItemChart = drawChart(issuedChartData.items, 'issued-item-chart', issuedChartLabels, 'Items'); 
	issuedPremiumChart = drawChart(issuedChartData.premiums, 'issued-premium-chart', issuedChartLabels, 'Premium'); 
	issuedPointChart = drawChart(issuedChartData.points, 'issued-point-chart', issuedChartLabels, 'Points'); 
}

function populateIssuedStats(stats) {

	issuedItems = 0, issuedPremium = 0, issuedPoints = 0;
	issuedDataArray = [];
	var agentKeys = Object.keys(salesData.agents); 
    for (var i = 0; i < agentKeys.length; i++) {
    	var k = agentKeys[i]; 
        var a = salesData.agents[k]; 
        var premStats = stats.premiums[k];
        var itemStats = stats.items[k];
        var pointStats = stats.points[k];
        var brokerStats = stats.broker[k];
        if ((a.salesProducer == '1' && a.active == '1') || premStats || itemStats || pointStats || brokerStats) {
			var rowData = {
				id: k, 
				name: getShortName(a), 
				items: (itemStats ? itemStats.total : 0), 
				premiums: (premStats ? (premStats.total[0] + premStats.total[1]) : 0),
				premiumValues: (premStats ? (premStats.total[0] + premStats.total[1]) : 0),
				points: (pointStats ? (pointStats.gain + pointStats.loss) : 0) 
			}; 
			if (brokerStats) {
				rowData.premiums += (brokerStats.total[0] + brokerStats.total[1]); 
			}

        	issuedItems += rowData.items; 
        	issuedPoints += rowData.points; 
        	issuedPremium += rowData.premiums; 
        	
			rowData.premiums = formatDollar(Math.round(rowData.premiums / 100));

			issuedDataArray.push(rowData);
        }
    }
    issuedPremium = Math.round(issuedPremium / 100); 

	sortIssuedDataArray();
	populateIssuedStatsTable();
	drawIssuedCharts(); 
	setIssuedDetailLabel(); 

	if (!isCompanyAdmin && !isOwnerAgent) {
		populateIssuedDetails(stats);
	}
}

function populateIssuedStatsTable(){
	$('#issued-sales-detail-body').html('') ;
	issuedChartData = {items: [], points: [], premiums: []} ;
	issuedChartLabels = [] ; 
	var  t = _.template($( "#tmplIssuedDetail" ).html());
    for (var i = 0; i < issuedDataArray.length; i++) {
		var d = issuedDataArray[i];
		if (isCompanyAdmin || isOwnerAgent) {
			var htm = t(d);
    		$('#issued-sales-detail-body').append(htm); 
		}
    	issuedChartLabels.push(d.name); 
    	issuedChartData.items.push(d.items); 	
    	issuedChartData.premiums.push( Math.round(d.premiumValues / 100) ); 	
    	issuedChartData.points.push(d.points);
    }
    transformAvatar('#issued-sales-detail-body');
}

function populateIssuedDetails(stats) {
	var premStats = stats.premiums[myId];
    var itemStats = stats.items[myId];
    var pointStats = stats.points[myId];
    var brokerStats = stats.broker[myId]; 
    
	var p = premStats ? (premStats.total[0] + premStats.total[1]) : 0
	if (brokerStats) {
		p +=  (brokerStats.total[0] + brokerStats.total[1]);
	}
    $('#my-issued-items').html(itemStats? itemStats.total : 0); 
    $('#my-issued-premiums').html(formatDollar(Math.round(p / 100))); 
    $('#my-issued-points').html(pointStats ? (pointStats.gain + pointStats.loss) : 0); 
    	
	if (stats.comps && stats.comps.length > 0) {
		$('#allstate-issued').show(); 
		var  t = _.template($( "#tmplComp" ).html());
		$('#allstate-issued-body').html('') ;
		
		
		for (var i = 0; i < stats.comps.length; i++) {
			var c = stats.comps[i];
			var gross = parseInt(c.issueAmt); 
			var change = parseInt(c.changeAmt);  
			var rowData = {
				name: c.customerLastname,
				net: formatDollar( Math.round((gross + change) / 100) ), 
				gross: formatDollar(Math.round(gross/100)), 
				change: formatDollar(Math.round(change/100)) 
			}; 
			var htm = t(rowData);
        	$('#allstate-issued-body').append(htm); 
		}
	}
	else {
		$('#allstate-issued').hide();
	}

	if (stats.ivantages && stats.ivantages.length > 0) {
		$('#ivantage-issued').show(); 

			var  t = _.template($( "#tmplIvantage" ).html());
			$('#ivantage-issued-body').html('') ;
			
			for (var i = 0; i < stats.ivantages.length; i++) {
				var c = stats.ivantages[i];
				var htm = t(c);
	        	$('#ivantage-issued-body').append(htm); 
			}
		
	}
	else {
		$('#ivantage-issued').hide(); 
	}
	
	return true; 
}

function setIssuedDetailLabel() {
	switch (currentIssuedTab) {
	case '#issued-items': 
		$('#issued-detail-type').html('Items'); 
		$('#issued-detail-count').html(issuedItems); 
		break;
	case '#issued-premium': 
		$('#issued-detail-type').html('Premium'); 
		$('#issued-detail-count').html(formatDollar(issuedPremium)); 
		break;
	case '#issued-points': 
		$('#issued-detail-type').html('Points'); 
		$('#issued-detail-count').html(issuedPoints); 
		break;
	}	
}

function sortIssuedDataArray() {
	issuedDataArray.sort(function(o1, o2) {
		var cmp = 0; 
		switch (currentSort) {
		case 'name': cmp = o1.name.localeCompare(o2.name); break; 
		case 'premiumValues': cmp = o1.premiumValues -o2.premiumValues; break; 
		case 'items': cmp = o1.items -o2.items; break; 
		case 'points': cmp = o1.points -o2.points; break;
		}
		return currentOrderDesc? (0 - cmp) : cmp; 
	});
}

function reloadAlr() {
	var params = alrInit ? '&nogoal=1' : ''; 
	
	hasFilter = false; 
	if (currentLoc != null && currentLoc != '') {
		params += ('&loc=' + currentLoc); 
		hasFilter = true; 
	}
	if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
		params += ('&lsp=' + currentAgent); 
		hasFilter = true; 
	}
	if (currentPeriod != 'mtd') {
		hasFilter = true; 
	}
	$.getJSON('/dashboard/alr-data?period=' + 
			encodeURIComponent(currentPeriod) + params )
	.done(function(data) {
		$.extend(alrData, data);
		populateAlrStats();	
	});
}

function populateAlrStats() {
	var productionCredits = 0, ips = 0, appts = 0, leads = 0, appCredits = 0, appIps=0;  
	var agentKeys = Object.keys(salesData.agents); 
	$('#alr-list-body').html(''); 
	var  t = _.template($( "#tmplAlrStat" ).html());


	var alrChartData = {ips: [], pc: [], apps: [], appDollars: [], appts: [], leads: []} ;
	var alrChartLabels = []; 
	
	
    for (var i = 0; i <= agentKeys.length ; i++) {
    	var k = (i == agentKeys.length ? '' : agentKeys[i]); 
        var a = (i == agentKeys.length ? null : salesData.agents[k]); 
        var ms = alrData.stats[k];
        var ml = alrData.leads[k]; 

        if (!( ms || ml || (a != null && a.active == '1' && a.salesProducer=='1')))  continue;
        
        alrChartLabels.push(a? a.name : 'Affiliated EFS'); 

        var theips = 0, thepc =0, theappts=0, theapppc=0, theappips=0, thelead = 0; 
        if ( ms || ml) {
			var rowData = {
				name: a? a.name : 'Affiliated EFS',
				id: a? a.id : 0
			}; 
			if (ms) {
				rowData['pc'] = formatDollar(parseInt(ms.credits)); 
				rowData['ips'] = ms.ips;  
				rowData['appts'] = ms.appts;  
				rowData['appPc'] = formatDollar(parseInt(ms.appCredits)); 
				rowData['appIps'] = ms.appIps;  
				
				thepc = parseInt(ms.credits); 
	        	theips = parseInt(ms.ips); 
	        	theappts = parseInt(ms.appts); 
	        	theapppc = parseInt(ms.appCredits); 
	        	theappips = parseInt(ms.appIps); 

	        	productionCredits += thepc; 
	        	ips += theips; 
	        	appts += theappts; 
	        	appCredits += theapppc; 
	        	appIps += theappips; 
	        	
			}
			
			if (ml) {
				rowData['leads'] = ml.leadCount;
				thelead =parseInt(ml.leadCount); 
				leads += thelead; 
			}
        	var htm = t(rowData);
        	$('#alr-list-body').append(htm); 
        }
        alrChartData.ips.push(theips); 
        alrChartData.pc.push(thepc); 
        alrChartData.apps.push(theappips); 
        alrChartData.appDollars.push(theapppc); 
        alrChartData.appts.push(theappts); 
        alrChartData.leads.push(thelead);  	
    }
	
    alrSum[0] = ips; 
    alrSum[1] = formatDollar(productionCredits);
    alrSum[2] = appIps; 
    alrSum[3] = formatDollar(appCredits); 
    alrSum[4] = appts; 
    alrSum[5] = leads; 
    transformAvatar('#alr-list');
    drawAlrCharts(alrChartData, alrChartLabels); 
    setAlrLabel();
}


function setAlrLabel() {
	switch (currentAlrTab) {
	case '#issued-ips': 
		$('#alr-type').html('Issued'); 
		$('#alr-count').html(alrSum[0]); 
		break;
	case '#issued-pc': 
		$('#alr-type').html('$ Issued'); 
		$('#alr-count').html(alrSum[1]);  
		break;
	case '#app-ips': 
		$('#alr-type').html('Submitted'); 
		$('#alr-count').html(alrSum[2]); 
		break;
	case '#app-pc': 
		$('#alr-type').html('$ Submitted'); 
		$('#alr-count').html(alrSum[3]); 
		break;
	case '#appts': 
		$('#alr-type').html('Appointments'); 
		$('#alr-count').html(alrSum[4]); 
		break;
	case '#leads': 
		$('#alr-type').html('Leads'); 
		$('#alr-count').html(alrSum[5]); 
		break;
	}	
}
function  drawAlrCharts(alrChartData, alrChartLabels) {
	for (var i = 0; i < alrCharts.length; i++) {
		alrCharts[i].destroy(); 
	}
	alrCharts = []; 
	var issuedIpsChart =  drawChart(alrChartData.ips, 'issued-ips-chart', alrChartLabels, 'Issued'); 
	alrCharts.push(issuedIpsChart); 
	var issuedPcChart =  drawChart(alrChartData.pc, 'issued-pc-chart', alrChartLabels, '$ Issued'); 
	alrCharts.push(issuedPcChart); 

	var appIpsChart =  drawChart(alrChartData.apps, 'app-ips-chart', alrChartLabels, 'Submitted'); 
	alrCharts.push(appIpsChart); 

	var appPcChart =  drawChart(alrChartData.appDollars, 'app-pc-chart', alrChartLabels, '$ Submitted'); 
	alrCharts.push(appPcChart); 

	var apptChart =  drawChart(alrChartData.appts, 'appts-chart', alrChartLabels, 'Appointments'); 
	alrCharts.push(apptChart); 

	var leadChart =  drawChart(alrChartData.leads, 'leads-chart', alrChartLabels, 'Leads'); 
	alrCharts.push(leadChart); 
	
	
}

function drawTerminationCompareCharts() {
	if (terminationItemChart) terminationItemChart.destroy(); 
	if (terminationPremiumChart) terminationPremiumChart.destroy(); 
	if (terminationPolicyChart) terminationPolicyChart.destroy(); 
	if (terminationWrittenItemChart) terminationWrittenItemChart.destroy(); 
	if (terminationWrittenPremiumChart) terminationWrittenPremiumChart.destroy(); 
	if (terminationWrittenPolicyChart) terminationWrittenPolicyChart.destroy(); 

	terminationItemChart = doDrawCompareChart(terminationWrittenChartData.items, terminationChartData.items, 'termination-item-chart', terminationChartLabels, 'Items', 'Written', 'Termination'); 
	terminationPremiumChart = doDrawCompareChart(terminationWrittenChartData.premium, terminationChartData.premium, 'termination-premium-chart', terminationChartLabels, 'Premium', 'Written', 'Termination'); 
	terminationPolicyChart = doDrawCompareChart(terminationWrittenChartData.policies, terminationChartData.policies, 'termination-policy-chart', terminationChartLabels, 'Policies', 'Written', 'Termination'); 
}

function reloadActivity() {
	$.getJSON('/dashboard/activity-data?period=' + 
			encodeURIComponent(currentPeriod)  )
	.done(function(data) {
		activityData = data;
		populateActivityStats();	
	});
}

function reloadAnalytics() {
	var params = '&nogoal=1&noagents=1&nobizdays=1&nobranch=1&noinsco=1'; 

	hasFilter = false; 
	if (currentLoc != null && currentLoc != '') {
		params += ('&loc=' + currentLoc); 
		hasFilter = true; 
	}
	if (currentAgent != null && currentAgent != '' && currentAgent != 0) {
		params += ('&lsp=' + currentAgent); 
		hasFilter = true; 
	}
	if(analyticsType == 'written'){
		$.getJSON('/dashboard/analytics-data?'+ params)
		.done(function(data) {
			analyticsData = data.analytics;
			salesGoalData = data.goals;
			populateAnalytics();	
		});
	} else {
		$.getJSON('/dashboard/analytics-issued-data?'+ params)
		.done(function(data) {
			analyticsWrittenData = data.written;
			analyticsIssuedData = data.issued;
			populateAnalyticsCompare();
		});
	}
}

function sortActivity(which) {
	var nextSort = $(which).data('sort'); 
	if (currentActivitySort != nextSort) {
		currentActivitySort = nextSort; 
		currentActivityOrderDesc = false;
	}
	else {
		currentActivityOrderDesc = !currentActivityOrderDesc; 
	}
		
	sortActivityData(); 
	populateActivityStats();	
	return false;
}

function populateActivityStats() {
	_.templateSettings.variable = "rc";
	var  t = _.template($( "#tmplActivity" ).html());
	var html = t(activityData); 
	$('#activity-list').html(html); 
	transformAvatar('#activity-list'); 

	t = _.template($("#tmplActivityTabs").html());
	html = t(activityData); 
	$('#activity-charts').html(html);

    t = _.template($("#tmplActivityContents").html());
    html = t(activityData);
    $('#activity-contents').html(html);

    $('#activityTable th a').on('click', function(e) {
		e.preventDefault(); 
		sortActivity(this);
	});
	
	loadActivityCharts();
	setActivityLabel();
}

function getGoalStat(data, goal) {
	switch (goal) {
		case GOAL_ITEMS: return data.items; 
		case GOAL_PREMIUM: return (data.premiums/100).toFixed(0);
		case GOAL_POINTS : return data.points; 
		case GOAL_AUTO: return data.auto; 
		case GOAL_HOME : return data.home; 
		case GOAL_IPS : return data.ips; 
		case GOAL_APPT : return data.appts; 
		case GOAL_POLICIES : return data.policies;
        case GOAL_REVENUE : return (data.commission/100).toFixed(0);
        case GOAL_CONDO : return data.condo;
        case GOAL_BASELINE : return data.baselinePolicies;
    }
	return 0;
}

function populateAnalytics() {
		$('#analytics-charts ul li:first-child a').html(goalTypes[goalType].toLowerCase());
	$('#analytics-charts ul li:nth-child(2) a').html(goalTypes[secondaryGoalType].toLowerCase());
	$('#analytics-charts ul li a, #analytics-charts div.tab-content .tab-pane').removeClass('active');
	$('#analytics-charts ul li:first-child a, #analytics-charts div.tab-content .tab-pane:first-child').addClass('active');
	
	var analyticsKeys = Object.keys(analyticsData); 
	analyticsCharts = {primarys: [], secondarys: []} ;
	salesGoalCharts = {primaryMetric:'', secondaryMetric:'', primaryGoals:[], secondaryGoals:[]};
	analyticsLabels = [];
	salesGoalCharts.primaryMetric = salesGoalData[analyticsKeys[analyticsKeys.length-1]]['primaryMetric'];
	salesGoalCharts.secondaryMetric = salesGoalData[analyticsKeys[analyticsKeys.length-1]]['secondaryMetric'];
	var firstGoalSet = getFirstGoalSet();
	for (var  i = 0; i < analyticsKeys.length; i++) {
		var a = analyticsData[analyticsKeys[i]]; 
		analyticsLabels.push(moment(analyticsKeys[i], "M/YYYY").format("MMM/YYYY")); 
		
		analyticsCharts.primarys.push(getGoalStat(a, salesGoalCharts.primaryMetric)); 
		analyticsCharts.secondarys.push(getGoalStat(a, salesGoalCharts.secondaryMetric)); 

		var primaryGoals = 0;
		var secondaryGoals = 0;
		if(salesGoalData[analyticsKeys[i]]['isSet']){
			primaryGoals = salesGoalData[analyticsKeys[i]]['primaryGoals'];
			secondaryGoals = salesGoalData[analyticsKeys[i]]['secondaryGoals'];
		} else {
			primaryGoals = firstGoalSet.primaryGoals;
			secondaryGoals = firstGoalSet.secondaryGoals;
		}
		salesGoalCharts.primaryGoals.push(primaryGoals);
		salesGoalCharts.secondaryGoals.push(secondaryGoals);
    }
    drawAnalyticsCharts();
}

function getFirstGoalSet() {
	var analyticsKeys = Object.keys(analyticsData);
	var goal = {primaryGoals:0,secondaryGoals:0};
	for (var  i = 0; i < analyticsKeys.length; i++) {
		if(salesGoalData[analyticsKeys[i]]['isSet']){
			goal.primaryGoals = salesGoalData[analyticsKeys[i]]['primaryGoals'];
			goal.secondaryGoals = salesGoalData[analyticsKeys[i]]['secondaryGoals'];
			return goal;
		}
    }
	return goal;
}

function populateAnalyticsCompare() {
	
	var thisMonth = moment(); 
	thisMonth.date(15); 
	thisMonth.subtract(11, 'months');

	wkeys = []; 
	ikeys = []; 
	for (var i =  0; i < 12; i++) {
		ikeys.push(thisMonth.format('YYYY-M')); 
		wkeys.push(thisMonth.format('M/YYYY')); 
		thisMonth.add(1, 'months'); 
	}
	populateAnalyticsWrittenData(wkeys);
	populateAnalyticsIssuedData(ikeys);
	drawAnalyticsCompareCharts();
}

function populateAnalyticsWrittenData(keys){
	analyticsWrittenCharts = {items: [], policies: [], points: [], premium: [], commission: []} ;
	analyticsLabels = [];
	for (var  i = 0; i < keys.length; i++) {
		
		analyticsLabels.push(moment(keys[i], "M/YYYY").format("MMM/YYYY")); 
		var a = analyticsWrittenData[keys[i]]; 
		
		analyticsWrittenCharts.items.push(a ? a.items : 0); 	
		analyticsWrittenCharts.premium.push(a ? (a.premiums/100).toFixed(0) : 0); 	
		analyticsWrittenCharts.policies.push(a ? a.policies : 0); 	
		analyticsWrittenCharts.points.push(a ? a.points : 0);
        analyticsWrittenCharts.commission.push(a ? (a.commission/100).toFixed(0) : 0);
    }
}

function populateAnalyticsIssuedData(keys){
	analyticsIssuedCharts = {items: [], policies: [], points: [], premium: []} ;

	for (var  i = 0; i < keys.length; i++) {
		var stats = analyticsIssuedData[keys[i]]; 
		
        analyticsIssuedCharts.items.push(stats? stats.items : 0); 	
    		analyticsIssuedCharts.premium.push(stats? (stats.premium/100).toFixed(0) : 0); 
   		analyticsIssuedCharts.points.push(stats? stats.points : 0);
    }
}

function loadActivityCharts(){
	var activityChartData = [] ;
	var activityChartLabels = []; 

	var stats = activityData.stats;
	var types = activityData.types;
	var applied = activityData.applied;
	for (var i = 0; i < types.length ; i++) {
        activityChartData[i] = [];
        activityChartLabels[i] = [];
        activitySum[i] = 0;
    	for (var j = 0; j < stats.length ; j++) {
        	if(types[i].applicableToAll == 0 && !isAppliedAgent(stats[j].agentId,applied[types[i].id])) {
				continue;
        	}
	        var theCount = typeof(stats[j][types[i].id]) == 'undefined' ? 0 : parseInt(stats[j][types[i].id]);
	        activityChartData[i].push(theCount); 
	        activityChartLabels[i].push(stats[j].firstname + ' ' + stats[j].lastname);
	        activitySum[i] += theCount;
		}
    }
    drawActivityCharts(activityChartData, activityChartLabels); 
}

function isAppliedAgent(agentId,appliedArr){
	for(var i = 0; i < appliedArr.length; i++) {
		if(agentId == appliedArr[i].agentId) {
			return true;
		}
	}
	return false;
}

function setActivityLabel() {
	var types = activityData.types;
	for (var i = 0; i < types.length ; i++) {
		if(currentActivityTab == ''){
			$('#activity-type').html(types[0].name); 
			$('#activity-count').html(activitySum[0]); 
		} else if(currentActivityTab.substr(10) == types[i].id) {
			$('#activity-type').html(types[i].name); 
			$('#activity-count').html(activitySum[i]); 
		}
	}
}

function  drawActivityCharts(activityChartData, activityChartLabels) {
	for (var i = 0; i < activityCharts.length; i++) {
		activityCharts[i].destroy(); 
	}
	activityCharts = []; 
	for (var i = 0; i < activityData.types.length; i++) {
		var typeName = activityData.types[i].name;
		var activityContainer = 'activityChart-'+activityData.types[i].id;
		var chart =  drawChart(activityChartData[i], activityContainer, activityChartLabels[i], typeName); 
		activityCharts.push(chart); 
	}
	
}

function sortActivityData() {
	activityData.stats.sort(function(o1, o2) {
		var cmp = 0; 
		switch (currentActivitySort) {
		case 'name': cmp = (o1.lastname + ' ' + o1.firstname ) .localeCompare(o2.lastname + ' ' + o2.firstname); break; 
		default: 
			var t1 = (o1[currentActivitySort] ? o1[currentActivitySort] : 0); 
			var t2 = (o2[currentActivitySort] ? o2[currentActivitySort] : 0); 
			cmp = t1 - t2; 
			break;  
		}
		return currentActivityOrderDesc? (0 - cmp) : cmp; 
	});
}

function editPolicyDates(which) {
	$('#unbound-reminder a').popover('hide');
	$('#gdlg h4.modal-title').html('Policy Dates'); 
	$('#gdlgContent').attr('src',  $(which).attr('href') + '&t=' + Date.now()); 
	$('#gdlg').modal('show'); 
	
	return false;
}

function goalPromptIfNeeded() {
	if (hasGoals) return; 
	$('#goal-setup-warning').removeClass('d-none');
}

function sortChartData(chartData, chartLabels) {
    var currentData = [];
    for (var i = 0; i < chartData.length; i++) { 
        var data = {};
        data['chartData'] = chartData[i];
        data['label'] = chartLabels[i];
        currentData.push(data);
    }
    
    currentData.sort(function (d1, d2) {
        return d2.chartData - d1.chartData;
    });

    var sortedChartData = [];
    var sortedLabels = [];
    for (var i = 0; i < currentData.length; i++) {
        sortedChartData.push(currentData[i].chartData);
        sortedLabels.push(currentData[i].label);
    }
    return {sortedChartData: sortedChartData, sortedLabels: sortedLabels};
}


$(window).on('message', function(e) {
    var msg = e.originalEvent.data;
    if (msg == 'reload-chart') {
        reloadChart(false);
    }
});
</script>


<script type="text/template" id="tmplDetail">
    <tr  data-source="<%-rc.id%>" id="row<%- rc.id %>">
        <td><img width="32" class="rounded-circle" height="32" avatar="<%- rc.name %>"></span>
            <a href="javascript:selectAgent(<%- rc.id %>)"><%- rc.name %></a>
        </td>
        <td class="text-center"><%- rc.items %></td>
        <td class="text-center"><%- rc.premiums %></td>
        <td class="text-center"><%- rc.policies %></td>
                <td class="text-center"><%- rc.auto %></td>
        <td class="text-center"><%- rc.home %></td>
    </tr>
</script>

<script type="text/template" id="tmplMonthGoal">
    <div class="db-tabs-row">
        <div class="row">
            <div class="col-sm-12 col-lg-6 db-tabs-row-col-wrapper has-progress">
                <div class="name-progress">
                    <a href="javascript:selectAgent(<%- rc.agentId %>)"><h3><%- rc.name %></h3></a>
                    <div class="month-progress-indicator">
                        <div class="month-progress-indicator-inner">
                            <span style="width: <%- rc.mtdPercentDisplay %>%"></span>
                        </div>
                        <small><b><%- rc.mtdPercent %>%</b> OF GOAL</small>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-lg-6 db-tabs-row-cols">
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <h2><%- rc.monthGoalDisplay %></h2>
                        <small>MONTH GOAL</small>
                    </div>
                </div>
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <h2><%- rc.monthSales %></h2>
                        <small>ACHIEVED MTD</small>
                    </div>
                </div>
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <h2><%- rc.trending %></h2>
                        <small>TRENDING FOR</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/template" id="tmplTodayGoal">
    <div class="db-tabs-row">
        <div class="row">
            <div class="col-md-12 col-lg-4 db-tabs-row-col-wrapper">
                <div class="name-progress">
                    <% if (rc.todayAchievedPercent == 100) { %>
                    <img src="/img/radial-bar-success.svg" alt="">
                    <% } else { %>
                    <div class="progress-pie-color goal-progress" data-value="<%- rc.todayAchievedPercent %>"></div>
                    <% } %>
                    <a href="javascript:selectAgent(<%- rc.agentId %>)"><h3><%- rc.name %> </h3></a>
                </div>
            </div>
            <div class="col-md-12 col-lg-8 db-tabs-row-cols">
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <h2><%- rc.todayNeedDisplay %></h2>
                        <small>GOAL TODAY</small>
                    </div>
                </div>
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <h2><%- rc.todaySalesDisplay %></h2>
                        <small>ACHIEVED TODAY</small>
                    </div>
                </div>
                <div class="db-tabs-row-col is-centered">
                    <div class="db-pricing-holder">
                        <% if (rc.todayNeed == 0 || rc.todaySales >= rc.todayNeed) { %>
                        <h2>On Pace</h2>
                        <% } else { %>
                        <h2><%- rc.todayStillDisplay %></h2>
                        <small>STILL NEEDED</small>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/template" id="tmplPolicy">
	<tr data-source="<%-rc.policyId%>" id="row<%- rc.policyId %>">
		<td>
			<a href="/customer/index?id=<%- rc.id %>&name=<%- rc.housename %>"><%- rc.housename %></a>
		</td>
		
		<td class="text-center">
			<%- moment(rc.signedDate).format('MMM DD') %>
		</td>
		
		<td class="text-center">
			<%= rc.insTypeName %>
		</td>
				<td class="text-center">
			$<%- (rc.premium / 100).toFixed(2) %>
		</td>
        	</tr>
</script>


<script type="text/template" id="tmplIssuedDetail">
	<tr data-source="<%-rc.id%>" id="row<%- rc.id %>">
		<td>
			<img width="32" class="rounded-circle" height="32" avatar="<%- rc.name %>">
			<a href="javascript:selectAgent(<%- rc.id %>)"><span class="dashboard-agent"><%- rc.name %></span></a>
		</td>
	
		<td class="text-center">
			<%- rc.premiums %>
		</td>
			
		<td class="text-center">
			<%- rc.items %>
		</td>
			
		<td class="text-center">
			<%- rc.points %>
		</td>
		
	</tr>
</script>



<script type="text/template" id="tmplComp">
	<tr>
		<td>
			<%- rc.name %>
		</td>
	
		<td class="text-center">
			<%- rc.net %>
		</td>
			
		<td class="text-center">
			<%- rc.gross %>
		</td>
			
		<td class="text-center">
			<%- rc.change %>
		</td>
		
	</tr>
</script>



<script type="text/template" id="tmplIvantage">
	<tr>
		<td>
			<%- rc.vendor %>
		</td>
	
		<td >
			<%- rc.customerName %>
		</td>
			
		<td class="text-center">
			<%- rc.product %>
		</td>
			
		<td class="text-center">
			<%- formatDollar(Math.round(rc.transactionAmt/100)) %>
		</td>
		
	</tr>
</script>


<script type="text/template" id="tmplAlrStat">
	<tr>
		<td>
			<img width="32" class="rounded-circle" height="32" avatar="<%- rc.name %>">
			<a href="javascript:selectAgent(<%- rc.id %>)"><span class="dashboard-agent"><%- rc.name %></span></a>
		</td>
	
		<td class="text-center">
			<%- rc.ips %>
		</td>
	
		<td class="text-center">
			<%- rc.pc %>
		</td>
			
		<td class="text-center">
			<%- rc.appIps %>
		</td>
	
		<td class="text-center">
			<%- rc.appPc %>
		</td>
			
		<td class="text-center">
			<%- rc.appts %>
		</td>
		<td class="text-center">
			<%- rc.leads %>
		</td>
		
	</tr>
</script>


<script type="text/template" id="tmplActivity">
	<table id="activityTable" cellpadding="12">
		<thead>
            <tr class="batch-options-section">
                <th colspan="<%- rc.types.length+1 %>" class="batch-options">

                </th>
            </tr>
			<tr>
				<th class=" text-muted"><a data-sort="name" href="#"><span class="dashboard-agent">Agent</span> 
					<i class="fa <%- currentActivitySort=='name'? (currentActivityOrderDesc? 'fa-sort-down' : 'fa-sort-up') : 'fa-sort' %>"></i></a></th>
				<% for (var i = 0; i < rc.types.length; i++) { var t = rc.types[i]; %>
				<th class="text-center text-muted"><a data-sort="<%-t.id%>" href="#"><%-t.name%> 
					<i class="fa <%- currentActivitySort==t.id? (currentActivityOrderDesc? 'fa-sort-down' : 'fa-sort-up') : 'fa-sort' %>"></i></a></th>
				<% } %>		
			</tr>
		</thead>
		<tbody>
			<% for (var i = 0; i < rc.stats.length; i++) { var s = rc.stats[i]; %>
			<tr>
				<td style="white-space: nowrap;">
					<img width="24" class="rounded-circle" height="24" avatar="<%- s.firstname %> <%- s.lastname %>">
					<span class="dashboard-agent"><%- s.firstname %> <%- s.lastname %></span>
				</td>
				<% for (var j = 0; j < rc.types.length; j++) { var t = rc.types[j];  %>
				<td class="text-center">	<% if(t.applicableToAll == 1 || isAppliedAgent(s.agentId,activityData.applied[t.id])) %> <%- s[t.id] %></td>
				<% } %>		
			</tr>
			<% } %>		
		</tbody>
	</table>
</script>

<script type="text/template" id="tmplActivityCharts">
			<ul class="nav nav-tabs flat-tabs" role="tablist">
			<% for (var i = 0; i < rc.types.length; i++) { var t = rc.types[i]; %>
				<li role="presentation" class="nav-item lg <% if(currentActivityTab==''&&i==0) {print('active');} else if(t.id == currentActivityTab.substr(10)) {print('active');} %>"><a href="#activity-<%- t.id %>" class="nav-link" data-toggle="tab"><%- t.name.length >= 10 ? t.name.substr(0,10)+'...' : t.name %></a></li>
			<% } %>
			</ul>
			<div class="tab-content">
			<% for (var i = 0; i < rc.types.length; i++) { var type = rc.types[i]; %>
				<div role="tabpanel" class="wizard-step tab-pane <% if(currentActivityTab==''&&i==0) {print('active');} else if(type.id == currentActivityTab.substr(10)) {print('active');} %>" id="activity-<%- type.id %>">
					<div class="canvas-container mt-10" style="width:100%;height:280px;">
						<canvas id="activityChart-<%- type.id %>" width="100%" height="280"></canvas>
					</div>
				</div>
			<% } %>
			</div>
</script>

<script type="text/template" id="tmplActivityTabs">
    <div class="db-nav-holder">
        <ul class="nav nav-tabs" role="tablist">
            <% for (var i = 0; i < rc.types.length; i++) { var t = rc.types[i]; %>
            <li class="nav-item">
                <a href="#activity-<%- t.id %>" class="nav-link <% if(currentActivityTab==''&&i==0) {print('active');} else if(t.id == currentActivityTab.substr(10)) {print('active');} %>" data-toggle="tab">
                    <%- t.name.length >= 10 ? t.name.substr(0,10)+'...' : t.name %>
                </a>
            </li>
            <% } %>
        </ul>
    </div>
</script>

<script type="text/template" id="tmplActivityContents">
    <div class="tab-content">
        <% for (var i = 0; i < rc.types.length; i++) { var type = rc.types[i]; %>
        <div role="tabpanel" class="wizard-step tab-pane <% if(currentActivityTab==''&&i==0) {print('active');} else if(type.id == currentActivityTab.substr(10)) {print('active');} %>" id="activity-<%- type.id %>">
            <div id="activityChart-<%- type.id %>"></div>
        </div>
        <% } %>
    </div>
</script>


<script>
window.fbAsyncInit = function() {
	FB.init({
		appId      : '282050618982144',
		cookie     : true,
		xfbml      : true,
		version    : 'v2.10'
	});
};

(function(d, s, id) {
    //determine if the browser is IE
    // https://github.com/cowboy/jquery-hashchange/pull/50/files

  var isIE = /msie/.test(navigator.userAgent.toLowerCase());
  if (!isIE) {
  	var js, fjs = d.getElementsByTagName(s)[0];
  	if (d.getElementById(id)) return;
  	js = d.createElement(s); js.id = id;
  	js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.10&appId=282050618982144';
 	 fjs.parentNode.insertBefore(js, fjs);
  }
}(document, 'script', 'facebook-jssdk'));

</script>                        </div>
        </div>

        
                <div class="modal fade timeline-modal" id="my-scheduler">
            <div class="modal-dialog taskedit-dialog" style="width:600px;">
                <div class="modal-content">
                    <div class="modal-header mb-3">           
                        <h2 class="modal-title">Share my scheduling page</h2>  
                        <button class="close" aria-label="Close" data-dismiss="modal">
                            <span aria-hidden="true"><i class="fal fa-times"></i></span>
                        </button>
                    </div>
                    <div class="modal-body" style="height:350px;">
                        <iframe  id="my-scheduler-content" src="" width="100%" seamless frameborder="0" height="100%;"></iframe>      
                    </div>
                </div>
            </div>
        </div>
        <script src="/js/common/notification-client.js"></script>
<script src="/js/common/notify-sidebar.js"></script>
<script src="/assets/310036a9/dist/placeload.js"></script>
<script src="/js/confetti-effect.js"></script>
<script>jQuery(function ($) {
$(function() {
        WelcomePacket.init('Abdul');
}); 
window.gnotify = new NotificationClient({"agentId":73089,"websocketServer":"wss:\/\/msg.agencyzoom.com\/","websocketPath":"\/socket"});
NotifySidebar.init()
});</script>        <script>
window.intercomSettings = {
    app_id: "dfjnajda",
    user_id: "PROD73089",
    user_hash: "24992289da86a60975999f49454d0d6831cd6a0b00d8012e681066549768be0e",
    Main_Focus_User_Goal: 1500,
    Main_Focus_User_Actual: 0,
    Main_Focus_Agency_Goal: 451500,
    Main_Focus_Agency_Actual: 0,
    Total_policies: 0,
    Leads: 0,
    company: {
        company_id: "PROD7331",
        plan: "Growth",
        monthly_spend: 2,
        Total_policies: "42",
        Total_leads: "3358",
        comp_plans: 0,
        comp_runs: 0,
    }
};

</script>
<script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/dfjnajda';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();</script>                        <script>
    if (!document.currentScript) {
        var script = document.createElement('script');
        script.setAttribute('src', '/js/tagify.polyfills.min.js');
        document.head.appendChild(script);
    }
</script>        <canvas id="confetti-holder"></canvas>
<button type="button" class="start-confetti d-none"></button>
<script>
var wasShownConfetti = false;
function showConfetti() {
    if (wasShownConfetti) {
        return;
    }
    wasShownConfetti = true;
    setTimeout(function () {
        $('.start-confetti').trigger('click');
    }, 1500);
}

$(window).on('message', function(e) {
    var msg = e.originalEvent.data;
    if (msg == 'show-confetti') {
        showConfetti();
    }
});
</script>        
        <script type="text/template" id="notif-templ">
    <% for ( var i = 0; i < rc.notifications.length; i++ ) { var notif = rc.notifications[i]; %>
        <% if (rc.isPop) {%>
        <div class="notif-item mt-2 <%=notif.success ? 'az-notif-popup--success' : '' %> <%=notif.error ? 'az-notif-popup--danger' : '' %>">
            <div class="az-notif-popup__top">
                <h2><%=notif.title ?? 'information notification'%></h2>
    
                <div class="az-notif-popup__close">
                    <i class="far fa-times"></i>
                </div>
            </div>
            <div class="az-notif-popup__main">
        <% } %>        
            <div class="az-notif-row <%=notif.status == 2 ? 'az-notif-row--read' : '' %>">
                <a href="javascript:void(0)" 
                   class="az-notif-row__left <%  if ( notif.success ) { %> az-notif-row--success <% } %> <%  if ( notif.error ) { %> az-notif-row--danger <% } %> notif-redirect" 
                   data-resourcecode="<%=notif.resourceCode%>" 
                   data-path="<%=notif.url()%>" 
                   data-status="<%=notif.status%>" 
                >
                    <div class="az-notif-row__avatar" style="background-image: url('<%-notif.avatar %>');">
                        <% if ( notif.avatar ) { %>
                        <% } else if ( notif.iconClass ) { %>
                            <i class="<%- notif.iconClass %>"></i>
                        <% } else { %>
                            <i class="fas fa-bell-exclamation"></i>
                        <% } %>
                    </div>
                    <div class="az-notif-row__info">
                        <div class="az-notif-row__action">
                            <% if (!rc.isPop) { %>
                            <h4><%=notif.title %></h4>
                            <% } %>
                            <%=notif.body %>
                        </div>
        
                        <div class="az-notif-row__meta">
                            <%-notif.fromNow %>
                        </div>
                    </div>
                </a>
        
                <% if (notif.status) { %>
                    <div class="az-notif-row__status">
                        <span></span>
                    </div>
                <% } %>
            </div>
        <% if (rc.isPop) {%>        
            </div>
        </div>
        <% } %>
    <% } %>
</script>
<script type="text/template" id="notifyListEmpty">
    <div class="az-zero-state mb-3">
        <div class="az-zero-state__icon">
            <i class="fas fa-bell-slash"></i>
        </div>
        <div class="az-zero-state__text">
            There are no notifications.
        </div>
    </div>
</script>
        <script>
            window.calendarBetaInvite = 0;

            $(function () {
                MenuSummaryStat.init();

                var activeSideNavSelector = "menudashboard";
                if (activeSideNavSelector) {
                    activeSideNav(activeSideNavSelector);
                };
                $('.main').on('click',function(){
                    $('.option-my-agency').removeClass('show-level2');
                });
            })
        </script>
    </body>
    </html>
